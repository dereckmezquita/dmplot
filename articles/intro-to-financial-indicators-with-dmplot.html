<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="dmplot">
<title>Introduction to financial indicators with dmplot • dmplot</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to financial indicators with dmplot">
<meta property="og:description" content="dmplot">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dmplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/getting-started-with-the-dmplot-framwork.html">Getting Started with the dmplot Framework</a>
    <a class="dropdown-item" href="../articles/intro-to-financial-indicators-with-dmplot.html">Intro to Financial Indicators with dmplot</a>
    <a class="dropdown-item" href="../articles/cpp-high-performance-technical-indicators.html">C++ high-performance technical indicators</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/donate.html">Donate</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dereckmezquita/dmplot" target="_blank">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.youtube.com/@derecksyoutube" target="_blank">
    <span class="fa fa-youtube fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://derecksnotes.com" target="_blank">derecksnotes.com</a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Introduction to financial indicators with dmplot</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dereckmezquita/dmplot/blob/HEAD/vignettes/intro-to-financial-indicators-with-dmplot.Rmd" class="external-link"><code>vignettes/intro-to-financial-indicators-with-dmplot.Rmd</code></a></small>
      <div class="d-none name"><code>intro-to-financial-indicators-with-dmplot.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette explains how to calculate and interpret common
financial indicators used in technical analysis. We’ll cover the
mathematics behind each indicator and demonstrate the functions used to
calculate them as well as leverage those provided by
<code>dmplot</code>. Finally, we’ll demonstrate how to visualise these
indicators using the <code>dmplot</code> package.</p>
<div class="section level3">
<h3 id="licensing">Licensing<a class="anchor" aria-label="anchor" href="#licensing"></a>
</h3>
<p>The <code>dmplot</code> package is released under the MIT license,
allowing free use and modification. Users must:</p>
<ol style="list-style-type: decimal">
<li>Cite the original author (see <a href="https://dereckmezquita.github.io/dmplot/LICENSE-text.html">LICENSE</a>
for details).</li>
<li>Include the license in any redistribution.</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>See the getting started for installing the recommended libraries: <a href="">Getting Started with The dmplot Framework</a></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span>dt <span class="op">=</span> <span class="va">data.table</span><span class="op">)</span></span>
<span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span><span class="va">dmplot</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="loading-sample-data">Loading Sample Data<a class="anchor" aria-label="anchor" href="#loading-sample-data"></a>
</h2>
<p>We’ll use the same sample data as in the README:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span><span class="va">kucoin</span><span class="op">[</span> <span class="va">get_market_data</span> <span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ticker</span> <span class="op">&lt;-</span> <span class="st">"BTC/USDT"</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">get_market_data</span><span class="op">(</span></span>
<span>    symbols <span class="op">=</span> <span class="va">ticker</span>,</span>
<span>    from <span class="op">=</span> <span class="st">"2024-06-30 11:34:17 EST"</span>, <span class="co"># lubridate::now() - lubridate::days(7),</span></span>
<span>    to <span class="op">=</span> <span class="st">"2024-07-07 11:34:12 EST"</span>, <span class="co"># lubridate::now(),</span></span>
<span>    frequency <span class="op">=</span> <span class="st">"1 hour"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;      symbol            datetime    open    high     low   close   volume</span></span>
<span><span class="co">#&gt;      &lt;char&gt;              &lt;POSc&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: BTC/USDT 2024-06-30 11:00:00 61540.9 61665.8 61518.7 61553.3 43.87309</span></span>
<span><span class="co">#&gt; 2: BTC/USDT 2024-06-30 12:00:00 61553.3 61654.9 61333.0 61490.7 63.42409</span></span>
<span><span class="co">#&gt; 3: BTC/USDT 2024-06-30 13:00:00 61490.8 61740.9 61451.1 61711.7 52.80176</span></span>
<span><span class="co">#&gt; 4: BTC/USDT 2024-06-30 14:00:00 61711.7 61846.7 61526.1 61581.7 89.92135</span></span>
<span><span class="co">#&gt; 5: BTC/USDT 2024-06-30 15:00:00 61581.7 61775.6 61580.9 61717.4 34.02352</span></span>
<span><span class="co">#&gt; 6: BTC/USDT 2024-06-30 16:00:00 61719.7 61749.6 61578.4 61601.8 27.14692</span></span>
<span><span class="co">#&gt; 1 variable(s) not shown: [turnover &lt;num&gt;]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="calculating-and-visualising-financial-indicators">Calculating and Visualising Financial Indicators<a class="anchor" aria-label="anchor" href="#calculating-and-visualising-financial-indicators"></a>
</h2>
<p>Being that we adhere to “Tidy Data” principles and the
<code>ggplot2</code> framework we can easily calculate and build our
visualisations in layers.</p>
<p>The first set is to create a set of base layers we then reuse
throughout the visualisations.</p>
<div class="section level3">
<h3 id="base-layers">Base Layers<a class="anchor" aria-label="anchor" href="#base-layers"></a>
</h3>
<div class="section level4">
<h4 id="candlestick-chart">Candlestick Chart<a class="anchor" aria-label="anchor" href="#candlestick-chart"></a>
</h4>
<p>A candlestick chart is a type of financial chart used to represent
price movements in a security. Each candlestick typically shows the
open, high, low, and close prices for a specific period.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">candle_plot</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">datetime</span>,</span>
<span>        open <span class="op">=</span> <span class="va">open</span>,</span>
<span>        high <span class="op">=</span> <span class="va">high</span>,</span>
<span>        low <span class="op">=</span> <span class="va">low</span>,</span>
<span>        close <span class="op">=</span> <span class="va">close</span></span>
<span>    <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co">## ------------------------------------</span></span>
<span>    <span class="va">dmplot</span><span class="op">$</span><span class="fu">stat_candlestick</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co">## ------------------------------------</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">scale_x_datetime</span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 day"</span>, date_labels <span class="op">=</span> <span class="st">"%b %d"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">labs</span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">ticker</span>, <span class="st">"- Candlestick with EMA and Bollinger Bands"</span><span class="op">)</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Price (USD)"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">dmplot</span><span class="op">$</span><span class="fu">theme_dereck_dark</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">candle_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-financial-indicators-with-dmplot_files/figure-html/candlestick-1.png" width="1800" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="line-chart">Line Chart<a class="anchor" aria-label="anchor" href="#line-chart"></a>
</h4>
<p>Sometimes we may want to visualise a single indicator or price
movement over time. A line chart is a simple and effective way to do
this.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">line_plot</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">datetime</span>,</span>
<span>        y <span class="op">=</span> <span class="va">close</span></span>
<span>    <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">geom_line</span><span class="op">(</span></span>
<span>        colour <span class="op">=</span> <span class="st">"cyan"</span>,</span>
<span>        linewidth <span class="op">=</span> <span class="fl">1.25</span>,</span>
<span>        alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>        na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">scale_x_datetime</span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 day"</span>, date_labels <span class="op">=</span> <span class="st">"%b %d"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">labs</span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">ticker</span>, <span class="st">"- Closing Price"</span><span class="op">)</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Price (USD)"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">dmplot</span><span class="op">$</span><span class="fu">theme_dereck_dark</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">line_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-financial-indicators-with-dmplot_files/figure-html/line-chart-1.png" width="1800" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="volume">Volume<a class="anchor" aria-label="anchor" href="#volume"></a>
</h4>
<p>The volume indicator is not a financial indicator <em>per se</em>,
but it is commonly used in conjunction with other indicators to confirm
price trends.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">volume_plot</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">|&gt;</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">datetime</span>,</span>
<span>        y <span class="op">=</span> <span class="va">volume</span>,</span>
<span>        group <span class="op">=</span> <span class="va">symbol</span></span>
<span>    <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">geom_bar</span><span class="op">(</span></span>
<span>        stat <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>        <span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">close</span> <span class="op">&gt;</span> <span class="va">open</span>, <span class="st">"green"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        linewidth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">scale_x_datetime</span><span class="op">(</span></span>
<span>        date_breaks <span class="op">=</span> <span class="st">"1 day"</span>,</span>
<span>        date_minor_breaks <span class="op">=</span> <span class="st">"1 hour"</span>,</span>
<span>        date_labels <span class="op">=</span> <span class="st">"%d %b"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">scale_fill_identity</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">labs</span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Volume"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">dmplot</span><span class="op">$</span><span class="fu">theme_dereck_dark</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">theme</span><span class="op">(</span></span>
<span>        axis.text.x <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">volume_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-financial-indicators-with-dmplot_files/figure-html/plot-volume-1.png" width="1800" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="simple-moving-average-sma">1. Simple Moving Average (SMA)<a class="anchor" aria-label="anchor" href="#simple-moving-average-sma"></a>
</h3>
<p>The Simple Moving Average (SMA) is the average of a security’s price
over a specified number of periods.</p>
<p><strong>Mathematics:</strong> for a series Y, the SMA at time t is
calculated as:</p>
<p><span class="math display">\[
SMA(t) = \frac{Y(t) + Y(t-1) + ... + Y(t-n+1)}{n}
\]</span></p>
<p>where n is the number of periods.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sma</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">TTR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TTR/man/MovingAverages.html" class="external-link">SMA</a></span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">$</span><span class="fu">copy</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data2</span><span class="op">[</span>, <span class="va">sma_short</span> <span class="op">:=</span> <span class="fu"><a href="../reference/sma.html">sma</a></span><span class="op">(</span><span class="va">close</span>, n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="va">data2</span><span class="op">[</span>, <span class="va">sma_long</span> <span class="op">:=</span> <span class="fu"><a href="../reference/sma.html">sma</a></span><span class="op">(</span><span class="va">close</span>, n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data2</span><span class="op">)</span></span>
<span><span class="co">#&gt;      symbol            datetime    open    high     low   close   volume</span></span>
<span><span class="co">#&gt;      &lt;char&gt;              &lt;POSc&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: BTC/USDT 2024-06-30 11:00:00 61540.9 61665.8 61518.7 61553.3 43.87309</span></span>
<span><span class="co">#&gt; 2: BTC/USDT 2024-06-30 12:00:00 61553.3 61654.9 61333.0 61490.7 63.42409</span></span>
<span><span class="co">#&gt; 3: BTC/USDT 2024-06-30 13:00:00 61490.8 61740.9 61451.1 61711.7 52.80176</span></span>
<span><span class="co">#&gt; 4: BTC/USDT 2024-06-30 14:00:00 61711.7 61846.7 61526.1 61581.7 89.92135</span></span>
<span><span class="co">#&gt; 5: BTC/USDT 2024-06-30 15:00:00 61581.7 61775.6 61580.9 61717.4 34.02352</span></span>
<span><span class="co">#&gt; 6: BTC/USDT 2024-06-30 16:00:00 61719.7 61749.6 61578.4 61601.8 27.14692</span></span>
<span><span class="co">#&gt; 3 variable(s) not shown: [turnover &lt;num&gt;, sma_short &lt;num&gt;, sma_long &lt;num&gt;]</span></span></code></pre></div>
<p>Now using the candlestick plot we created earlier, we can add the SMA
layer to visualise the moving averages.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sma_layer</span> <span class="op">&lt;-</span> <span class="va">dmplot</span><span class="op">$</span><span class="fu">stat_movingaverages</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data2</span>,</span>
<span>        <span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, short <span class="op">=</span> <span class="va">sma_short</span>, long <span class="op">=</span> <span class="va">sma_long</span><span class="op">)</span>,</span>
<span>        alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mavg <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">candle_plot</span> <span class="op">+</span> <span class="va">sma_layer</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-financial-indicators-with-dmplot_files/figure-html/plot-sma-1.png" width="1800" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="candlestick-chart-with-ema-and-bollinger-bands">Candlestick Chart with EMA and Bollinger Bands<a class="anchor" aria-label="anchor" href="#candlestick-chart-with-ema-and-bollinger-bands"></a>
</h3>
</div>
<div class="section level3">
<h3 id="exponential-moving-average-ema">1. Exponential Moving Average (EMA)<a class="anchor" aria-label="anchor" href="#exponential-moving-average-ema"></a>
</h3>
<p>The EMA gives more weight to recent prices, making it more responsive
to new information than a simple moving average.</p>
<p><strong>Mathematics:</strong> for a series Y, the EMA at time t is
calculated as:</p>
<p><span class="math display">\[
EMA(t) = α * Y(t) + (1 - α) * EMA(t-1)
\]</span></p>
<p>where α = 2 / (N + 1), and N is the number of periods.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ema</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, <span class="va">wilder</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">TTR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TTR/man/MovingAverages.html" class="external-link">EMA</a></span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="va">n</span>, wilder <span class="op">=</span> <span class="va">wilder</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">$</span><span class="fu">copy</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data2</span><span class="op">[</span>, <span class="fu">`:=`</span><span class="op">(</span></span>
<span>    ema_short <span class="op">=</span> <span class="fu"><a href="../reference/ema.html">ema</a></span><span class="op">(</span><span class="va">close</span>, n <span class="op">=</span> <span class="fl">10</span>, wilder <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    ema_long <span class="op">=</span> <span class="fu"><a href="../reference/ema.html">ema</a></span><span class="op">(</span><span class="va">close</span>, n <span class="op">=</span> <span class="fl">50</span>, wilder <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data2</span><span class="op">)</span></span>
<span><span class="co">#&gt;      symbol            datetime    open    high     low   close   volume</span></span>
<span><span class="co">#&gt;      &lt;char&gt;              &lt;POSc&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: BTC/USDT 2024-06-30 11:00:00 61540.9 61665.8 61518.7 61553.3 43.87309</span></span>
<span><span class="co">#&gt; 2: BTC/USDT 2024-06-30 12:00:00 61553.3 61654.9 61333.0 61490.7 63.42409</span></span>
<span><span class="co">#&gt; 3: BTC/USDT 2024-06-30 13:00:00 61490.8 61740.9 61451.1 61711.7 52.80176</span></span>
<span><span class="co">#&gt; 4: BTC/USDT 2024-06-30 14:00:00 61711.7 61846.7 61526.1 61581.7 89.92135</span></span>
<span><span class="co">#&gt; 5: BTC/USDT 2024-06-30 15:00:00 61581.7 61775.6 61580.9 61717.4 34.02352</span></span>
<span><span class="co">#&gt; 6: BTC/USDT 2024-06-30 16:00:00 61719.7 61749.6 61578.4 61601.8 27.14692</span></span>
<span><span class="co">#&gt; 3 variable(s) not shown: [turnover &lt;num&gt;, ema_short &lt;num&gt;, ema_long &lt;num&gt;]</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ema_layer</span> <span class="op">&lt;-</span> <span class="va">dmplot</span><span class="op">$</span><span class="fu">stat_movingaverages</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data2</span>,</span>
<span>        <span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, short <span class="op">=</span> <span class="va">ema_short</span>, long <span class="op">=</span> <span class="va">ema_long</span><span class="op">)</span>,</span>
<span>        alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mavg <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>        colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"cyan"</span>, <span class="st">"magenta"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">candle_plot</span> <span class="op">+</span> <span class="va">ema_layer</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-financial-indicators-with-dmplot_files/figure-html/plot-ema-1.png" width="1800" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="bollinger-bands">2. Bollinger Bands<a class="anchor" aria-label="anchor" href="#bollinger-bands"></a>
</h3>
<p>Bollinger Bands consist of a middle band (usually a simple moving
average) and an upper and lower band that are standard deviations away
from the middle band.</p>
<p><strong>Mathematics:</strong></p>
<p><span class="math display">\[ Middle Band = SMA(n) \]</span> <span class="math display">\[ Upper Band = SMA(n) + k * σ(n) \]</span> <span class="math display">\[ Lower Band = SMA(n) - k * σ(n) \]</span></p>
<p>where SMA(n) is the n-period simple moving average, σ(n) is the
n-period standard deviation, and k is the number of standard deviations
(usually 2).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bb</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">close</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">20</span>, <span class="va">sd</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">TTR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TTR/man/bollingerBands.html" class="external-link">BBands</a></span><span class="op">(</span><span class="va">close</span>, n <span class="op">=</span> <span class="va">n</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">$</span><span class="fu">copy</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data2</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bb_lower"</span>, <span class="st">"bb_mavg"</span>, <span class="st">"bb_upper"</span>, <span class="st">"bb_pct"</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="../reference/bb.html">bb</a></span><span class="op">(</span><span class="va">close</span>, n <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data2</span><span class="op">)</span></span>
<span><span class="co">#&gt;      symbol            datetime    open    high     low   close   volume</span></span>
<span><span class="co">#&gt;      &lt;char&gt;              &lt;POSc&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: BTC/USDT 2024-06-30 11:00:00 61540.9 61665.8 61518.7 61553.3 43.87309</span></span>
<span><span class="co">#&gt; 2: BTC/USDT 2024-06-30 12:00:00 61553.3 61654.9 61333.0 61490.7 63.42409</span></span>
<span><span class="co">#&gt; 3: BTC/USDT 2024-06-30 13:00:00 61490.8 61740.9 61451.1 61711.7 52.80176</span></span>
<span><span class="co">#&gt; 4: BTC/USDT 2024-06-30 14:00:00 61711.7 61846.7 61526.1 61581.7 89.92135</span></span>
<span><span class="co">#&gt; 5: BTC/USDT 2024-06-30 15:00:00 61581.7 61775.6 61580.9 61717.4 34.02352</span></span>
<span><span class="co">#&gt; 6: BTC/USDT 2024-06-30 16:00:00 61719.7 61749.6 61578.4 61601.8 27.14692</span></span>
<span><span class="co">#&gt; 5 variable(s) not shown: [turnover &lt;num&gt;, bb_lower &lt;num&gt;, bb_mavg &lt;num&gt;, bb_upper &lt;num&gt;, bb_pct &lt;num&gt;]</span></span></code></pre></div>
<p>As you can see in the plot below Bolllinger Bands are a great way to
visualise price volatility and see when a security is overbought or
oversold.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bb_layer</span> <span class="op">&lt;-</span> <span class="va">dmplot</span><span class="op">$</span><span class="fu">stat_bollingerbands</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data2</span>,</span>
<span>        <span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">bb_lower</span>, mavg <span class="op">=</span> <span class="va">bb_mavg</span>, ymax <span class="op">=</span> <span class="va">bb_upper</span><span class="op">)</span>,</span>
<span>        colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"pink"</span>, <span class="st">"cyan"</span>, <span class="st">"cyan"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">candle_plot</span> <span class="op">+</span> <span class="va">bb_layer</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-financial-indicators-with-dmplot_files/figure-html/plot-bollinger-bands-1.png" width="1800" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="fibonacci-retracement-fib">3. Fibonacci Retracement (Fib)<a class="anchor" aria-label="anchor" href="#fibonacci-retracement-fib"></a>
</h3>
<p>Fibonacci retracement is a popular tool used in technical analysis to
identify potential support and resistance levels based on the Fibonacci
sequence.</p>
<p><strong>Mathematics:</strong></p>
<p>The Fibonacci retracement levels are calculated as follows:</p>
<ul>
<li>0.000 (0.0%)</li>
<li>0.236 (23.6%)</li>
<li>0.382 (38.2%)</li>
<li>0.500 (50.0%)</li>
<li>0.618 (61.8%)</li>
<li>0.786 (78.6%)</li>
<li>1.000 (100.0%)</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">$</span><span class="fu">copy</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">high_price</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">data2</span><span class="op">$</span><span class="va">high</span><span class="op">)</span></span>
<span><span class="va">low_price</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">data2</span><span class="op">$</span><span class="va">low</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fib_levels</span> <span class="op">&lt;-</span> <span class="va">dmplot</span><span class="op">$</span><span class="fu">fib</span><span class="op">(</span><span class="va">high_price</span>, <span class="va">low_price</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fib_levels</span><span class="op">)</span></span>
<span><span class="co">#&gt; $levels</span></span>
<span><span class="co">#&gt; [1] 0.000 0.236 0.382 0.500 0.618 0.786 1.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $prices</span></span>
<span><span class="co">#&gt; [1] 63850.00 61369.57 59835.07 58594.85 57354.63 55588.90 53339.70</span></span></code></pre></div>
<p>In the plot we overlay the Fibonacci retracement levels on the
candlestick chart to identify potential support and resistance
levels.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fib_plot</span> <span class="op">&lt;-</span> <span class="va">candle_plot</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">geom_hline</span><span class="op">(</span></span>
<span>        yintercept <span class="op">=</span> <span class="va">fib_levels</span><span class="op">$</span><span class="va">prices</span>, color <span class="op">=</span> <span class="st">"yellow"</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">scale_y_continuous</span><span class="op">(</span></span>
<span>        name <span class="op">=</span> <span class="st">"Price"</span>,</span>
<span>        sec.axis <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">sec_axis</span><span class="op">(</span></span>
<span>            <span class="op">~</span> <span class="op">(</span><span class="va">.</span> <span class="op">-</span> <span class="va">low_price</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="va">high_price</span> <span class="op">-</span> <span class="va">low_price</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span>,</span>
<span>            name <span class="op">=</span> <span class="st">"Retracement %"</span>,</span>
<span>            labels <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">1</span><span class="op">)</span>, <span class="st">"%"</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">labs</span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"Price Chart with Fibonacci Retracement Levels"</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Date"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">fib_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-financial-indicators-with-dmplot_files/figure-html/plot-fib-1.png" width="1800" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="moving-average-convergence-divergence-macd">4. Moving Average Convergence Divergence (MACD)<a class="anchor" aria-label="anchor" href="#moving-average-convergence-divergence-macd"></a>
</h3>
<p>MACD is a trend-following momentum indicator that shows the
relationship between two moving averages of a security’s price.</p>
<p><strong>Mathematics:</strong></p>
<p><span class="math display">\[ MACD Line = EMA(12) - EMA(26) \]</span>
<span class="math display">\[ Signal Line = EMA(9) of MACD Line
\]</span> <span class="math display">\[ MACD Histogram = MACD Line -
Signal Line \]</span></p>
<p>The MACD Line is the difference between a short-term EMA (12 periods)
and a long-term EMA (26 periods). The Signal Line is the EMA of the MACD
Line (usually 9 periods).</p>
<p>When the MACD Line crosses above the Signal Line, it is considered a
bullish signal. When the MACD Line crosses below the Signal Line, it is
considered a bearish signal.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">macd</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">fast</span> <span class="op">=</span> <span class="fl">12</span>, <span class="va">slow</span> <span class="op">=</span> <span class="fl">26</span>, <span class="va">signal</span> <span class="op">=</span> <span class="fl">9</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">TTR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TTR/man/MACD.html" class="external-link">MACD</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">fast</span>, <span class="va">slow</span>, <span class="va">signal</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">$</span><span class="fu">copy</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data2</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"macd"</span>, <span class="st">"macd_signal"</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="../reference/macd.html">macd</a></span><span class="op">(</span><span class="va">close</span>, fast <span class="op">=</span> <span class="fl">12</span>, slow <span class="op">=</span> <span class="fl">26</span>, signal <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">data2</span><span class="op">[</span>, <span class="va">macd_diff</span> <span class="op">:=</span> <span class="va">macd</span> <span class="op">-</span> <span class="va">macd_signal</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data2</span><span class="op">)</span></span>
<span><span class="co">#&gt;      symbol            datetime    open    high     low   close   volume</span></span>
<span><span class="co">#&gt;      &lt;char&gt;              &lt;POSc&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: BTC/USDT 2024-06-30 11:00:00 61540.9 61665.8 61518.7 61553.3 43.87309</span></span>
<span><span class="co">#&gt; 2: BTC/USDT 2024-06-30 12:00:00 61553.3 61654.9 61333.0 61490.7 63.42409</span></span>
<span><span class="co">#&gt; 3: BTC/USDT 2024-06-30 13:00:00 61490.8 61740.9 61451.1 61711.7 52.80176</span></span>
<span><span class="co">#&gt; 4: BTC/USDT 2024-06-30 14:00:00 61711.7 61846.7 61526.1 61581.7 89.92135</span></span>
<span><span class="co">#&gt; 5: BTC/USDT 2024-06-30 15:00:00 61581.7 61775.6 61580.9 61717.4 34.02352</span></span>
<span><span class="co">#&gt; 6: BTC/USDT 2024-06-30 16:00:00 61719.7 61749.6 61578.4 61601.8 27.14692</span></span>
<span><span class="co">#&gt; 4 variable(s) not shown: [turnover &lt;num&gt;, macd &lt;num&gt;, macd_signal &lt;num&gt;, macd_diff &lt;num&gt;]</span></span></code></pre></div>
<p>As you can see in the plot below, the MACD indicator is a great way
to visualise the relationship between two moving averages and identify
potential buy or sell signals.</p>
<p>Our plot below shows the two moving averages and the MACD histogram;
the histogram is the difference between the MACD Line and the Signal
Line.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">macd_plot</span> <span class="op">&lt;-</span> <span class="va">data2</span> <span class="op">|&gt;</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">dmplot</span><span class="op">$</span><span class="fu">stat_macd</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data2</span>,</span>
<span>        <span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span>macd <span class="op">=</span> <span class="va">macd</span>, macd_signal <span class="op">=</span> <span class="va">macd_signal</span>, macd_diff <span class="op">=</span> <span class="va">macd_diff</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">dmplot</span><span class="op">$</span><span class="fu">theme_dereck_dark</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">scale_x_datetime</span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 day"</span>, date_labels <span class="op">=</span> <span class="st">"%b %d"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">labs</span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">ticker</span>, <span class="st">"- MACD"</span><span class="op">)</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"MACD Value"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">macd_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-financial-indicators-with-dmplot_files/figure-html/plot-macd-1.png" width="1800" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="relative-strength-index-rsi">5. Relative Strength Index (RSI)<a class="anchor" aria-label="anchor" href="#relative-strength-index-rsi"></a>
</h3>
<p>RSI is a momentum oscillator that measures the speed and change of
price movements.</p>
<p><strong>Mathematics:</strong></p>
<p><span class="math display">\[
RSI = 100 - (100 / (1 + RS))
\]</span></p>
<p>where RS = Average Gain / Average Loss</p>
<p><span class="math display">\[ Average Gain = [(previous avg. gain) x
13 + current gain] / 14 \]</span> <span class="math display">\[ Average
Loss = [(previous avg. loss) x 13 + current loss] / 14 \]</span></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rsi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">TTR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TTR/man/RSI.html" class="external-link">RSI</a></span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">$</span><span class="fu">copy</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data2</span><span class="op">[</span>, <span class="va">rsi</span> <span class="op">:=</span> <span class="fu"><a href="../reference/rsi.html">rsi</a></span><span class="op">(</span><span class="va">close</span>, n <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data2</span><span class="op">)</span></span>
<span><span class="co">#&gt;      symbol            datetime    open    high     low   close   volume</span></span>
<span><span class="co">#&gt;      &lt;char&gt;              &lt;POSc&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: BTC/USDT 2024-06-30 11:00:00 61540.9 61665.8 61518.7 61553.3 43.87309</span></span>
<span><span class="co">#&gt; 2: BTC/USDT 2024-06-30 12:00:00 61553.3 61654.9 61333.0 61490.7 63.42409</span></span>
<span><span class="co">#&gt; 3: BTC/USDT 2024-06-30 13:00:00 61490.8 61740.9 61451.1 61711.7 52.80176</span></span>
<span><span class="co">#&gt; 4: BTC/USDT 2024-06-30 14:00:00 61711.7 61846.7 61526.1 61581.7 89.92135</span></span>
<span><span class="co">#&gt; 5: BTC/USDT 2024-06-30 15:00:00 61581.7 61775.6 61580.9 61717.4 34.02352</span></span>
<span><span class="co">#&gt; 6: BTC/USDT 2024-06-30 16:00:00 61719.7 61749.6 61578.4 61601.8 27.14692</span></span>
<span><span class="co">#&gt; 2 variable(s) not shown: [turnover &lt;num&gt;, rsi &lt;num&gt;]</span></span></code></pre></div>
<p>The RSI provides a visual representation of the strength of a
security’s price movement. It is often used to identify overbought or
oversold conditions.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rsi_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">data2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">geom_line</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">rsi</span>, colour <span class="op">=</span> <span class="st">"RSI"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">geom_hline</span><span class="op">(</span></span>
<span>        yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">70</span><span class="op">)</span>,</span>
<span>        linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>        colour <span class="op">=</span> <span class="st">"yellow"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">scale_x_datetime</span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 day"</span>, date_labels <span class="op">=</span> <span class="st">"%b %d"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">scale_y_continuous</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RSI"</span> <span class="op">=</span> <span class="st">"cyan"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">labs</span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">ticker</span>, <span class="st">"- RSI"</span><span class="op">)</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"RSI Value"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">dmplot</span><span class="op">$</span><span class="fu">theme_dereck_dark</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">theme</span><span class="op">(</span></span>
<span>        axis.text.x <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        legend.position <span class="op">=</span> <span class="st">"none"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rsi_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-financial-indicators-with-dmplot_files/figure-html/plot-rsi-1.png" width="1800" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="rate-of-change-roc-momentum">6. Rate of Change (ROC) / Momentum<a class="anchor" aria-label="anchor" href="#rate-of-change-roc-momentum"></a>
</h3>
<p>The Rate of Change (ROC) indicator measures the percentage change in
price between the current price and the price n periods ago.</p>
<p><strong>Mathematics:</strong></p>
<p><span class="math display">\[
ROC = \frac{Close - Close_{n}}{Close_{n}}
\]</span></p>
<p>where n is the number of periods.</p>
<p>This is often used as a momentum indicator to identify overbought or
oversold conditions.</p>
<p>Notice how we execute a second calculation to normalise the momentum
values between -1 and 1.</p>
<p><span class="math display">\[
Momentum = \frac{ROC}{max(|ROC|)}
\]</span></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">$</span><span class="fu">copy</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data2</span><span class="op">[</span>, <span class="va">mom</span> <span class="op">:=</span> <span class="fu">TTR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TTR/man/changes.html" class="external-link">ROC</a></span><span class="op">(</span><span class="va">close</span>, n <span class="op">=</span> <span class="fl">2L</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">data2</span><span class="op">[</span>, <span class="va">mom</span> <span class="op">:=</span> <span class="va">mom</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">mom</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data2</span><span class="op">)</span></span>
<span><span class="co">#&gt;      symbol            datetime    open    high     low   close   volume</span></span>
<span><span class="co">#&gt;      &lt;char&gt;              &lt;POSc&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: BTC/USDT 2024-06-30 11:00:00 61540.9 61665.8 61518.7 61553.3 43.87309</span></span>
<span><span class="co">#&gt; 2: BTC/USDT 2024-06-30 12:00:00 61553.3 61654.9 61333.0 61490.7 63.42409</span></span>
<span><span class="co">#&gt; 3: BTC/USDT 2024-06-30 13:00:00 61490.8 61740.9 61451.1 61711.7 52.80176</span></span>
<span><span class="co">#&gt; 4: BTC/USDT 2024-06-30 14:00:00 61711.7 61846.7 61526.1 61581.7 89.92135</span></span>
<span><span class="co">#&gt; 5: BTC/USDT 2024-06-30 15:00:00 61581.7 61775.6 61580.9 61717.4 34.02352</span></span>
<span><span class="co">#&gt; 6: BTC/USDT 2024-06-30 16:00:00 61719.7 61749.6 61578.4 61601.8 27.14692</span></span>
<span><span class="co">#&gt; 2 variable(s) not shown: [turnover &lt;num&gt;, mom &lt;num&gt;]</span></span></code></pre></div>
<p>The Momentum indicator is a simple way to visualise the rate of
change in price over a specified number of periods.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mom</span> <span class="op">&lt;-</span> <span class="va">data2</span> <span class="op">|&gt;</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">datetime</span>,</span>
<span>        y <span class="op">=</span> <span class="va">mom</span>,</span>
<span>        group <span class="op">=</span> <span class="va">symbol</span></span>
<span>    <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co">## ------------------------------------</span></span>
<span>    <span class="co"># momentum</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">geom_line</span><span class="op">(</span></span>
<span>        colour <span class="op">=</span> <span class="st">"yellow"</span>,</span>
<span>        linewidth <span class="op">=</span> <span class="fl">1.25</span>,</span>
<span>        alpha <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>        na.rm <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co">## ------------------------------------</span></span>
<span>    <span class="co"># zero line</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">geom_hline</span><span class="op">(</span></span>
<span>        yintercept <span class="op">=</span> <span class="fl">0</span>, colour <span class="op">=</span> <span class="st">"grey"</span>, size <span class="op">=</span> <span class="fl">1</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">scale_x_datetime</span><span class="op">(</span></span>
<span>        date_breaks <span class="op">=</span> <span class="st">"1 day"</span>, date_minor_breaks <span class="op">=</span> <span class="st">"1 hour"</span>, date_labels <span class="op">=</span> <span class="st">"%d %b"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">labs</span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Momentum"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">dmplot</span><span class="op">$</span><span class="fu">theme_dereck_dark</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">theme</span><span class="op">(</span></span>
<span>        axis.text.x <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span>
<span>        panel.grid.minor <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mom</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-financial-indicators-with-dmplot_files/figure-html/plot-momentum-1.png" width="1800" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="stochastic-oscillator">7. Stochastic Oscillator<a class="anchor" aria-label="anchor" href="#stochastic-oscillator"></a>
</h3>
<p>The Stochastic Oscillator is a momentum indicator that shows the
location of the close relative to the high-low range over a set number
of periods.</p>
<p><strong>Mathematics:</strong></p>
<p><span class="math display">\[
%K = (Current Close - Lowest Low)/(Highest High - Lowest Low) * 100
\]</span></p>
<p><span class="math display">\[
%D = 3-day SMA of %K
\]</span></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stoch</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">high</span>, <span class="va">low</span>, <span class="va">close</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">14</span>, <span class="va">k</span> <span class="op">=</span> <span class="fl">3</span>, <span class="va">d</span> <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">TTR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TTR/man/stochastics.html" class="external-link">stoch</a></span><span class="op">(</span>HLC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">high</span>, <span class="va">low</span>, <span class="va">close</span><span class="op">)</span>, nFastK <span class="op">=</span> <span class="va">n</span>, nFastD <span class="op">=</span> <span class="va">k</span>, nSlowD <span class="op">=</span> <span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">$</span><span class="fu">copy</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data2</span><span class="op">[</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fastK"</span>, <span class="st">"fastD"</span>, <span class="st">"slowD"</span><span class="op">)</span> <span class="op">:=</span> <span class="fu">stoch</span><span class="op">(</span><span class="va">high</span>, <span class="va">low</span>, <span class="va">close</span>, n <span class="op">=</span> <span class="fl">14</span>, k <span class="op">=</span> <span class="fl">3</span>, d <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">]</span></span>
<span></span>
<span><span class="co"># similarly to the momentum indicator, we normalise the values between 0 and 100</span></span>
<span><span class="va">data2</span><span class="op">[</span>, <span class="va">fastK</span> <span class="op">:=</span> <span class="va">fastK</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">fastK</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">]</span></span>
<span><span class="va">data2</span><span class="op">[</span>, <span class="va">fastD</span> <span class="op">:=</span> <span class="va">fastD</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">fastD</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">]</span></span>
<span><span class="va">data2</span><span class="op">[</span>, <span class="va">slowD</span> <span class="op">:=</span> <span class="va">slowD</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">slowD</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data2</span><span class="op">)</span></span>
<span><span class="co">#&gt;      symbol            datetime    open    high     low   close   volume</span></span>
<span><span class="co">#&gt;      &lt;char&gt;              &lt;POSc&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: BTC/USDT 2024-06-30 11:00:00 61540.9 61665.8 61518.7 61553.3 43.87309</span></span>
<span><span class="co">#&gt; 2: BTC/USDT 2024-06-30 12:00:00 61553.3 61654.9 61333.0 61490.7 63.42409</span></span>
<span><span class="co">#&gt; 3: BTC/USDT 2024-06-30 13:00:00 61490.8 61740.9 61451.1 61711.7 52.80176</span></span>
<span><span class="co">#&gt; 4: BTC/USDT 2024-06-30 14:00:00 61711.7 61846.7 61526.1 61581.7 89.92135</span></span>
<span><span class="co">#&gt; 5: BTC/USDT 2024-06-30 15:00:00 61581.7 61775.6 61580.9 61717.4 34.02352</span></span>
<span><span class="co">#&gt; 6: BTC/USDT 2024-06-30 16:00:00 61719.7 61749.6 61578.4 61601.8 27.14692</span></span>
<span><span class="co">#&gt; 4 variable(s) not shown: [turnover &lt;num&gt;, fastK &lt;num&gt;, fastD &lt;num&gt;, slowD &lt;num&gt;]</span></span></code></pre></div>
<p>The Stochastic Oscillator is used to identify overbought or oversold
conditions. When the %K line crosses above the %D line, it is considered
a buy signal. When the %K line crosses below the %D line, it is
considered a sell signal.</p>
<ul>
<li>Dotted yellow lines represent the overbought (80) and oversold (20)
levels.</li>
<li>Purple line represents the Fast %K line; this represents the current
close relative to the high-low range over the last 14 periods.</li>
<li>Yellow line represents the Slow %D line; this is a 3-day SMA of the
Fast %K line.</li>
</ul>
<p>If the Fast %K line crosses above the Slow %D line, it is considered
a buy signal. If the Fast %K line crosses below the Slow %D line, it is
considered a sell signal.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stoch_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">data2</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">geom_line</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">fastK</span>, colour <span class="op">=</span> <span class="st">"Fast %K"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">geom_line</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span>y <span class="op">=</span> <span class="va">slowD</span>, colour <span class="op">=</span> <span class="st">"Slow %D"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">geom_hline</span><span class="op">(</span></span>
<span>        yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">80</span><span class="op">)</span>,</span>
<span>        linetype <span class="op">=</span> <span class="st">"dashed"</span>,</span>
<span>        colour <span class="op">=</span> <span class="st">"yellow"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">scale_x_datetime</span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 day"</span>, date_labels <span class="op">=</span> <span class="st">"%b %d"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">scale_y_continuous</span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">scale_color_manual</span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Fast %K"</span> <span class="op">=</span> <span class="st">"magenta"</span>, <span class="st">"Slow %D"</span> <span class="op">=</span> <span class="st">"yellow"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">labs</span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">ticker</span>, <span class="st">"- Stochastic Oscillator"</span><span class="op">)</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Value"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">dmplot</span><span class="op">$</span><span class="fu">theme_dereck_dark</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">stoch_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-financial-indicators-with-dmplot_files/figure-html/plot-stochastic-1.png" width="1800" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="pulling-it-all-together">Pulling it all together<a class="anchor" aria-label="anchor" href="#pulling-it-all-together"></a>
</h2>
<p>Now that we have built the individual layers, we can combine them
into a single plot to visualise all the indicators together.</p>
<p>For this we use the <code>gridExtra</code> package to arrange the
plots in a grid layout.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span><span class="va">gridExtra</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="candlestick-chart-rsi-volume">Candlestick Chart + RSI + Volume<a class="anchor" aria-label="anchor" href="#candlestick-chart-rsi-volume"></a>
</h3>
<p>Now we will have some fun and combine the candlestick chart, RSI, and
volume plots into a single layout.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">candle_plot_minus_x_axis</span> <span class="op">&lt;-</span> <span class="va">candle_plot</span> <span class="op">+</span></span>
<span>    <span class="va">ema_layer</span> <span class="op">+</span></span>
<span>    <span class="va">bb_layer</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">theme</span><span class="op">(</span></span>
<span>        axis.text.x <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">labs</span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">ticker</span>, <span class="st">"- Candlestick, EMA, Bollinger Bands, RSI, MACD, Volume"</span><span class="op">)</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Price (USD)"</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">rsi_plot_minus_x_axis</span> <span class="op">&lt;-</span> <span class="va">rsi_plot</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">theme</span><span class="op">(</span></span>
<span>        axis.text.x <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"RSI"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">macd_plot_minus_x_axis</span> <span class="op">&lt;-</span> <span class="va">macd_plot</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">theme</span><span class="op">(</span></span>
<span>        axis.text.x <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        axis.title.x <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">labs</span><span class="op">(</span>title <span class="op">=</span> <span class="cn">NULL</span>, y <span class="op">=</span> <span class="st">"MACD"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gridExtra</span><span class="op">$</span><span class="fu">grid.arrange</span><span class="op">(</span></span>
<span>    <span class="va">candle_plot_minus_x_axis</span>,</span>
<span>    <span class="va">rsi_plot_minus_x_axis</span>,</span>
<span>    <span class="va">macd_plot_minus_x_axis</span>,</span>
<span>    <span class="va">volume_plot</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">1</span>,</span>
<span>    heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="intro-to-financial-indicators-with-dmplot_files/figure-html/plot-candlestick-volume-1.png" width="1800" style="display: block; margin: auto;"></p>
<p><strong>Challenge: can you adjust the left padding on the plots so
the y-axis labels all align?</strong></p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This vignette has demonstrated how to calculate and visualise various
financial indicators using the <code>dmplot</code> package. We’ve
covered the mathematics behind each indicator and provided R functions
to calculate them. By combining these indicators with the visualisation
capabilities of <code>dmplot</code>, you can create comprehensive and
insightful financial charts.</p>
<p>Remember that while these indicators can be powerful tools for
technical analysis, they should be used in conjunction with other forms
of analysis and not relied upon exclusively for making investment
decisions.</p>
<p>For more advanced usage and customisation options, refer to the
individual function documentation in the <code>dmplot</code> package and
explore combining multiple indicators to create more complex trading
strategies.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://derecksnotes.com" class="external-link">Dereck Mezquita</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
