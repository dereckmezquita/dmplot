<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Understanding and Calculating Financial Indicators with dmplot • dmplot</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Understanding and Calculating Financial Indicators with dmplot">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dmplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/working-with-financial-data.html">Understanding and Calculating Financial Indicators with dmplot</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dereckmezquita/dmplot"><span class="fa fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Understanding and Calculating Financial Indicators with dmplot</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dereckmezquita/dmplot/blob/MISC-5-R-pkg-dmplot-working-with-financial-data-vignette/vignettes/working-with-financial-data.Rmd" class="external-link"><code>vignettes/working-with-financial-data.Rmd</code></a></small>
      <div class="d-none name"><code>working-with-financial-data.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette explains how to calculate and interpret common
financial indicators used in technical analysis. We’ll cover the
mathematics behind each indicator and provide R functions to calculate
them. Finally, we’ll demonstrate how to visualize these indicators using
the <code>dmplot</code> package.</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>First, let’s load the necessary libraries:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/dereckmezquita/dmplot" class="external-link">"dmplot"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://r-datatable.com" class="external-link">"data.table"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/joshuaulrich/TTR" class="external-link">"TTR"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://ggplot2.tidyverse.org" class="external-link">"ggplot2"</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="loading-sample-data">Loading Sample Data<a class="anchor" aria-label="anchor" href="#loading-sample-data"></a>
</h2>
<p>We’ll use the same sample data as in the README:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ticker</span> <span class="op">&lt;-</span> <span class="st">"BTC/USDT"</span></span>
<span></span>
<span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu">kucoin</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/kucoin/man/get_market_data.html" class="external-link">get_market_data</a></span><span class="op">(</span></span>
<span>    symbols <span class="op">=</span> <span class="va">ticker</span>,</span>
<span>    from <span class="op">=</span> <span class="st">"2022-11-28 15:29:43 EST"</span>,</span>
<span>    to <span class="op">=</span> <span class="st">"2022-12-05 15:29:31 EST"</span>,</span>
<span>    frequency <span class="op">=</span> <span class="st">"1 hour"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span></span>
<span><span class="co">#&gt;      symbol            datetime    open    high     low   close   volume</span></span>
<span><span class="co">#&gt;      &lt;char&gt;              &lt;POSc&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: BTC/USDT 2022-11-28 15:00:00 16215.3 16233.6 16126.0 16144.1 327.8979</span></span>
<span><span class="co">#&gt; 2: BTC/USDT 2022-11-28 16:00:00 16144.1 16382.6 16000.0 16305.9 837.5801</span></span>
<span><span class="co">#&gt; 3: BTC/USDT 2022-11-28 17:00:00 16305.9 16382.0 16195.4 16205.4 507.8351</span></span>
<span><span class="co">#&gt; 4: BTC/USDT 2022-11-28 18:00:00 16206.1 16230.7 16146.5 16162.6 252.3387</span></span>
<span><span class="co">#&gt; 5: BTC/USDT 2022-11-28 19:00:00 16161.7 16253.3 16150.1 16220.9 225.4121</span></span>
<span><span class="co">#&gt; 6: BTC/USDT 2022-11-28 20:00:00 16220.9 16268.0 16213.7 16261.0 169.2577</span></span>
<span><span class="co">#&gt; 1 variable(s) not shown: [turnover &lt;num&gt;]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="calculating-financial-indicators">Calculating Financial Indicators<a class="anchor" aria-label="anchor" href="#calculating-financial-indicators"></a>
</h2>
<div class="section level3">
<h3 id="exponential-moving-average-ema">1. Exponential Moving Average (EMA)<a class="anchor" aria-label="anchor" href="#exponential-moving-average-ema"></a>
</h3>
<p>The EMA gives more weight to recent prices, making it more responsive
to new information than a simple moving average.</p>
<p><strong>Mathematics:</strong> For a series Y, the EMA at time t is
calculated as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mi>M</mi><mi>A</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>α</mi><mo>*</mo><mi>Y</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>*</mo><mi>E</mi><mi>M</mi><mi>A</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">EMA(t) = α * Y(t) + (1 - α) * EMA(t-1)</annotation></semantics></math></p>
<p>where α = 2 / (N + 1), and N is the number of periods.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ema</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, <span class="va">wilder</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">TTR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TTR/man/MovingAverages.html" class="external-link">EMA</a></span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="va">n</span>, wilder <span class="op">=</span> <span class="va">wilder</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dt</span><span class="op">[</span>, <span class="fu">`:=`</span><span class="op">(</span></span>
<span>    ema_short <span class="op">=</span> <span class="fu">ema</span><span class="op">(</span><span class="va">close</span>, n <span class="op">=</span> <span class="fl">10</span>, wilder <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span>
<span>    ema_long <span class="op">=</span> <span class="fu">ema</span><span class="op">(</span><span class="va">close</span>, n <span class="op">=</span> <span class="fl">50</span>, wilder <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span></span>
<span><span class="co">#&gt;      symbol            datetime    open    high     low   close   volume</span></span>
<span><span class="co">#&gt;      &lt;char&gt;              &lt;POSc&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: BTC/USDT 2022-11-28 15:00:00 16215.3 16233.6 16126.0 16144.1 327.8979</span></span>
<span><span class="co">#&gt; 2: BTC/USDT 2022-11-28 16:00:00 16144.1 16382.6 16000.0 16305.9 837.5801</span></span>
<span><span class="co">#&gt; 3: BTC/USDT 2022-11-28 17:00:00 16305.9 16382.0 16195.4 16205.4 507.8351</span></span>
<span><span class="co">#&gt; 4: BTC/USDT 2022-11-28 18:00:00 16206.1 16230.7 16146.5 16162.6 252.3387</span></span>
<span><span class="co">#&gt; 5: BTC/USDT 2022-11-28 19:00:00 16161.7 16253.3 16150.1 16220.9 225.4121</span></span>
<span><span class="co">#&gt; 6: BTC/USDT 2022-11-28 20:00:00 16220.9 16268.0 16213.7 16261.0 169.2577</span></span>
<span><span class="co">#&gt; 3 variable(s) not shown: [turnover &lt;num&gt;, ema_short &lt;num&gt;, ema_long &lt;num&gt;]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bollinger-bands">2. Bollinger Bands<a class="anchor" aria-label="anchor" href="#bollinger-bands"></a>
</h3>
<p>Bollinger Bands consist of a middle band (usually a simple moving
average) and an upper and lower band that are standard deviations away
from the middle band.</p>
<p><strong>Mathematics:</strong></p>
<ul>
<li>Middle Band = SMA(n)</li>
<li>Upper Band = SMA(n) + k * σ(n)</li>
<li>Lower Band = SMA(n) - k * σ(n)</li>
</ul>
<p>where SMA(n) is the n-period simple moving average, σ(n) is the
n-period standard deviation, and k is the number of standard deviations
(usually 2).</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bb</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">close</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">20</span>, <span class="va">sd</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">TTR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TTR/man/bollingerBands.html" class="external-link">BBands</a></span><span class="op">(</span><span class="va">close</span>, n <span class="op">=</span> <span class="va">n</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dt</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bb_lower"</span>, <span class="st">"bb_mavg"</span>, <span class="st">"bb_upper"</span>, <span class="st">"bb_pct"</span><span class="op">)</span> <span class="op">:=</span> <span class="fu">bb</span><span class="op">(</span><span class="va">close</span>, n <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span></span>
<span><span class="co">#&gt;      symbol            datetime    open    high     low   close   volume</span></span>
<span><span class="co">#&gt;      &lt;char&gt;              &lt;POSc&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: BTC/USDT 2022-11-28 15:00:00 16215.3 16233.6 16126.0 16144.1 327.8979</span></span>
<span><span class="co">#&gt; 2: BTC/USDT 2022-11-28 16:00:00 16144.1 16382.6 16000.0 16305.9 837.5801</span></span>
<span><span class="co">#&gt; 3: BTC/USDT 2022-11-28 17:00:00 16305.9 16382.0 16195.4 16205.4 507.8351</span></span>
<span><span class="co">#&gt; 4: BTC/USDT 2022-11-28 18:00:00 16206.1 16230.7 16146.5 16162.6 252.3387</span></span>
<span><span class="co">#&gt; 5: BTC/USDT 2022-11-28 19:00:00 16161.7 16253.3 16150.1 16220.9 225.4121</span></span>
<span><span class="co">#&gt; 6: BTC/USDT 2022-11-28 20:00:00 16220.9 16268.0 16213.7 16261.0 169.2577</span></span>
<span><span class="co">#&gt; 7 variable(s) not shown: [turnover &lt;num&gt;, ema_short &lt;num&gt;, ema_long &lt;num&gt;, bb_lower &lt;num&gt;, bb_mavg &lt;num&gt;, bb_upper &lt;num&gt;, bb_pct &lt;num&gt;]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="moving-average-convergence-divergence-macd">3. Moving Average Convergence Divergence (MACD)<a class="anchor" aria-label="anchor" href="#moving-average-convergence-divergence-macd"></a>
</h3>
<p>MACD is a trend-following momentum indicator that shows the
relationship between two moving averages of a security’s price.</p>
<p><strong>Mathematics:</strong> MACD Line = EMA(12) - EMA(26) Signal
Line = EMA(9) of MACD Line MACD Histogram = MACD Line - Signal Line</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">macd</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">fast</span> <span class="op">=</span> <span class="fl">12</span>, <span class="va">slow</span> <span class="op">=</span> <span class="fl">26</span>, <span class="va">signal</span> <span class="op">=</span> <span class="fl">9</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">TTR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TTR/man/MACD.html" class="external-link">MACD</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">fast</span>, <span class="va">slow</span>, <span class="va">signal</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dt</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"macd"</span>, <span class="st">"macd_signal"</span><span class="op">)</span> <span class="op">:=</span> <span class="fu">macd</span><span class="op">(</span><span class="va">close</span>, fast <span class="op">=</span> <span class="fl">12</span>, slow <span class="op">=</span> <span class="fl">26</span>, signal <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">dt</span><span class="op">[</span>, <span class="va">macd_diff</span> <span class="op">:=</span> <span class="va">macd</span> <span class="op">-</span> <span class="va">macd_signal</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span></span>
<span><span class="co">#&gt;      symbol            datetime    open    high     low   close   volume</span></span>
<span><span class="co">#&gt;      &lt;char&gt;              &lt;POSc&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: BTC/USDT 2022-11-28 15:00:00 16215.3 16233.6 16126.0 16144.1 327.8979</span></span>
<span><span class="co">#&gt; 2: BTC/USDT 2022-11-28 16:00:00 16144.1 16382.6 16000.0 16305.9 837.5801</span></span>
<span><span class="co">#&gt; 3: BTC/USDT 2022-11-28 17:00:00 16305.9 16382.0 16195.4 16205.4 507.8351</span></span>
<span><span class="co">#&gt; 4: BTC/USDT 2022-11-28 18:00:00 16206.1 16230.7 16146.5 16162.6 252.3387</span></span>
<span><span class="co">#&gt; 5: BTC/USDT 2022-11-28 19:00:00 16161.7 16253.3 16150.1 16220.9 225.4121</span></span>
<span><span class="co">#&gt; 6: BTC/USDT 2022-11-28 20:00:00 16220.9 16268.0 16213.7 16261.0 169.2577</span></span>
<span><span class="co">#&gt; 10 variable(s) not shown: [turnover &lt;num&gt;, ema_short &lt;num&gt;, ema_long &lt;num&gt;, bb_lower &lt;num&gt;, bb_mavg &lt;num&gt;, bb_upper &lt;num&gt;, bb_pct &lt;num&gt;, macd &lt;num&gt;, macd_signal &lt;num&gt;, macd_diff &lt;num&gt;]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="relative-strength-index-rsi">4. Relative Strength Index (RSI)<a class="anchor" aria-label="anchor" href="#relative-strength-index-rsi"></a>
</h3>
<p>RSI is a momentum oscillator that measures the speed and change of
price movements.</p>
<p><strong>Mathematics:</strong></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>R</mi><mi>S</mi><mi>I</mi><mo>=</mo><mn>100</mn><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>100</mn><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>R</mi><mi>S</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
RSI = 100 - (100 / (1 + RS))
</annotation></semantics></math></p>
<p>where RS = Average Gain / Average Loss</p>
<ul>
<li>Average Gain = [(previous avg. gain) x 13 + current gain] / 14</li>
<li>Average Loss = [(previous avg. loss) x 13 + current loss] / 14</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rsi</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">14</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">TTR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TTR/man/RSI.html" class="external-link">RSI</a></span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dt</span><span class="op">[</span>, <span class="va">rsi</span> <span class="op">:=</span> <span class="fu">rsi</span><span class="op">(</span><span class="va">close</span>, n <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span></span>
<span><span class="co">#&gt;      symbol            datetime    open    high     low   close   volume</span></span>
<span><span class="co">#&gt;      &lt;char&gt;              &lt;POSc&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: BTC/USDT 2022-11-28 15:00:00 16215.3 16233.6 16126.0 16144.1 327.8979</span></span>
<span><span class="co">#&gt; 2: BTC/USDT 2022-11-28 16:00:00 16144.1 16382.6 16000.0 16305.9 837.5801</span></span>
<span><span class="co">#&gt; 3: BTC/USDT 2022-11-28 17:00:00 16305.9 16382.0 16195.4 16205.4 507.8351</span></span>
<span><span class="co">#&gt; 4: BTC/USDT 2022-11-28 18:00:00 16206.1 16230.7 16146.5 16162.6 252.3387</span></span>
<span><span class="co">#&gt; 5: BTC/USDT 2022-11-28 19:00:00 16161.7 16253.3 16150.1 16220.9 225.4121</span></span>
<span><span class="co">#&gt; 6: BTC/USDT 2022-11-28 20:00:00 16220.9 16268.0 16213.7 16261.0 169.2577</span></span>
<span><span class="co">#&gt; 11 variable(s) not shown: [turnover &lt;num&gt;, ema_short &lt;num&gt;, ema_long &lt;num&gt;, bb_lower &lt;num&gt;, bb_mavg &lt;num&gt;, bb_upper &lt;num&gt;, bb_pct &lt;num&gt;, macd &lt;num&gt;, macd_signal &lt;num&gt;, macd_diff &lt;num&gt;, ...]</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="stochastic-oscillator">5. Stochastic Oscillator<a class="anchor" aria-label="anchor" href="#stochastic-oscillator"></a>
</h3>
<p>The Stochastic Oscillator is a momentum indicator that shows the
location of the close relative to the high-low range over a set number
of periods.</p>
<p><strong>Mathematics:</strong></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow></mrow><annotation encoding="application/x-tex">
%K = (Current Close - Lowest Low)/(Highest High - Lowest Low) * 100
%D = 3-day SMA of %K
</annotation></semantics></math></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stoch</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">high</span>, <span class="va">low</span>, <span class="va">close</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">14</span>, <span class="va">k</span> <span class="op">=</span> <span class="fl">3</span>, <span class="va">d</span> <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">TTR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TTR/man/stochastics.html" class="external-link">stoch</a></span><span class="op">(</span>HLC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">high</span>, <span class="va">low</span>, <span class="va">close</span><span class="op">)</span>, nFastK <span class="op">=</span> <span class="va">n</span>, nFastD <span class="op">=</span> <span class="va">k</span>, nSlowD <span class="op">=</span> <span class="va">d</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">dt</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"fastK"</span>, <span class="st">"fastD"</span>, <span class="st">"slowD"</span><span class="op">)</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/pkg/TTR/man/stochastics.html" class="external-link">stoch</a></span><span class="op">(</span><span class="va">high</span>, <span class="va">low</span>, <span class="va">close</span>, n <span class="op">=</span> <span class="fl">14</span>, k <span class="op">=</span> <span class="fl">3</span>, d <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dt</span><span class="op">)</span></span>
<span><span class="co">#&gt;      symbol            datetime    open    high     low   close   volume</span></span>
<span><span class="co">#&gt;      &lt;char&gt;              &lt;POSc&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: BTC/USDT 2022-11-28 15:00:00 16215.3 16233.6 16126.0 16144.1 327.8979</span></span>
<span><span class="co">#&gt; 2: BTC/USDT 2022-11-28 16:00:00 16144.1 16382.6 16000.0 16305.9 837.5801</span></span>
<span><span class="co">#&gt; 3: BTC/USDT 2022-11-28 17:00:00 16305.9 16382.0 16195.4 16205.4 507.8351</span></span>
<span><span class="co">#&gt; 4: BTC/USDT 2022-11-28 18:00:00 16206.1 16230.7 16146.5 16162.6 252.3387</span></span>
<span><span class="co">#&gt; 5: BTC/USDT 2022-11-28 19:00:00 16161.7 16253.3 16150.1 16220.9 225.4121</span></span>
<span><span class="co">#&gt; 6: BTC/USDT 2022-11-28 20:00:00 16220.9 16268.0 16213.7 16261.0 169.2577</span></span>
<span><span class="co">#&gt; 14 variable(s) not shown: [turnover &lt;num&gt;, ema_short &lt;num&gt;, ema_long &lt;num&gt;, bb_lower &lt;num&gt;, bb_mavg &lt;num&gt;, bb_upper &lt;num&gt;, bb_pct &lt;num&gt;, macd &lt;num&gt;, macd_signal &lt;num&gt;, macd_diff &lt;num&gt;, ...]</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="visualizing-indicators-with-dmplot">Visualizing Indicators with dmplot<a class="anchor" aria-label="anchor" href="#visualizing-indicators-with-dmplot"></a>
</h2>
<p>Now that we have calculated our indicators, let’s use
<code>dmplot</code> to visualize them.</p>
<div class="section level3">
<h3 id="candlestick-chart-with-ema-and-bollinger-bands">Candlestick Chart with EMA and Bollinger Bands<a class="anchor" aria-label="anchor" href="#candlestick-chart-with-ema-and-bollinger-bands"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dt</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, open <span class="op">=</span> <span class="va">open</span>, high <span class="op">=</span> <span class="va">high</span>, low <span class="op">=</span> <span class="va">low</span>, close <span class="op">=</span> <span class="va">close</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">dmplot</span><span class="fu">::</span><span class="fu"><a href="../reference/stat_candlestick.html">stat_candlestick</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">dmplot</span><span class="fu">::</span><span class="fu"><a href="../reference/stat_movingaverages.html">stat_movingaverages</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>short <span class="op">=</span> <span class="va">ema_short</span>, long <span class="op">=</span> <span class="va">ema_long</span><span class="op">)</span>, </span>
<span>                                alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mavg <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">dmplot</span><span class="fu">::</span><span class="fu"><a href="../reference/stat_bollingerbands.html">stat_bollingerbands</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">bb_lower</span>, mavg <span class="op">=</span> <span class="va">bb_mavg</span>, ymax <span class="op">=</span> <span class="va">bb_upper</span><span class="op">)</span>, </span>
<span>                                colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"pink"</span>, <span class="st">"cyan"</span>, <span class="st">"cyan"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_datetime</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 day"</span>, date_labels <span class="op">=</span> <span class="st">"%b %d"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">ticker</span>, <span class="st">"- Candlestick with EMA and Bollinger Bands"</span><span class="op">)</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Price (USD)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">dmplot</span><span class="fu">::</span><span class="fu"><a href="../reference/theme_dereck_dark.html">theme_dereck_dark</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></code></pre></div>
<p><img src="working-with-financial-data_files/figure-html/plot_candlestick_ema_bb-1.png" width="900" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="macd-plot">MACD Plot<a class="anchor" aria-label="anchor" href="#macd-plot"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">macd_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dt</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">dmplot</span><span class="fu">::</span><span class="fu"><a href="../reference/stat_macd.html">stat_macd</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>macd <span class="op">=</span> <span class="va">macd</span>, macd_signal <span class="op">=</span> <span class="va">macd_signal</span>, macd_diff <span class="op">=</span> <span class="va">macd_diff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_datetime</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 day"</span>, date_labels <span class="op">=</span> <span class="st">"%b %d"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">ticker</span>, <span class="st">"- MACD"</span><span class="op">)</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Value"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">dmplot</span><span class="fu">::</span><span class="fu"><a href="../reference/theme_dereck_dark.html">theme_dereck_dark</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">macd_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="working-with-financial-data_files/figure-html/plot_macd-1.png" width="900" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="rsi-and-stochastic-oscillator">RSI and Stochastic Oscillator<a class="anchor" aria-label="anchor" href="#rsi-and-stochastic-oscillator"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rsi_stoch_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">dt</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">rsi</span>, color <span class="op">=</span> <span class="st">"RSI"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">fastK</span>, color <span class="op">=</span> <span class="st">"Fast %K"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">slowD</span>, color <span class="op">=</span> <span class="st">"Slow %D"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">70</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span>, color <span class="op">=</span> <span class="st">"yellow"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_date.html" class="external-link">scale_x_datetime</a></span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 day"</span>, date_labels <span class="op">=</span> <span class="st">"%b %d"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_continuous</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RSI"</span> <span class="op">=</span> <span class="st">"cyan"</span>, <span class="st">"Fast %K"</span> <span class="op">=</span> <span class="st">"magenta"</span>, <span class="st">"Slow %D"</span> <span class="op">=</span> <span class="st">"yellow"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">ticker</span>, <span class="st">"- RSI and Stochastic Oscillator"</span><span class="op">)</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Date"</span>, y <span class="op">=</span> <span class="st">"Value"</span>, color <span class="op">=</span> <span class="st">"Indicator"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">dmplot</span><span class="fu">::</span><span class="fu"><a href="../reference/theme_dereck_dark.html">theme_dereck_dark</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rsi_stoch_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="working-with-financial-data_files/figure-html/plot_rsi_stoch-1.png" width="900" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>This vignette has demonstrated how to calculate and visualize various
financial indicators using the <code>dmplot</code> package. We’ve
covered the mathematics behind each indicator and provided R functions
to calculate them. By combining these indicators with the visualization
capabilities of <code>dmplot</code>, you can create comprehensive and
insightful financial charts.</p>
<p>Remember that while these indicators can be powerful tools for
technical analysis, they should be used in conjunction with other forms
of analysis and not relied upon exclusively for making investment
decisions.</p>
<p>For more advanced usage and customisation options, refer to the
individual function documentation in the <code>dmplot</code> package and
explore combining multiple indicators to create more complex trading
strategies.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://derecksnotes.com" class="external-link">Dereck Mezquita</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
