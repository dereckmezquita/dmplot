<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="The `Pca` class implements Principal Component Analysis, a dimensionality reduction
technique widely used in data analysis and visualisation. This class provides methods
for performing PCA on a dataset, visualising the results, and interpreting the output."><title>Principal Component Analysis (PCA) Class — Pca • dmplot</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Principal Component Analysis (PCA) Class — Pca"><meta property="og:description" content="The `Pca` class implements Principal Component Analysis, a dimensionality reduction
technique widely used in data analysis and visualisation. This class provides methods
for performing PCA on a dataset, visualising the results, and interpreting the output."><meta property="og:image" content="https://dereckmezquita.github.io/dmplot/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">dmplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/fin_getting-started-with-the-dmplot-framwork-for-finance.html">Getting Started with the dmplot framework for finance</a>
    <a class="dropdown-item" href="../articles/fin_intro-to-financial-indicators-with-dmplot.html">Intro to Financial Indicators with dmplot</a>
    <a class="dropdown-item" href="../articles/fin_cpp-high-performance-technical-indicators.html">C++ high-performance technical indicators</a>
    <a class="dropdown-item" href="../articles/fin_intro-to-monte-carlo-simulations.html">Introduction to Monte Carlo Simulations</a>
    <a class="dropdown-item" href="../articles/bio_review-differential-expression-analysis-volcano-plots.html">Review differential expression analysis (DEA) and volcano plots</a>
    <a class="dropdown-item" href="../articles/stat_the-comparison-class-for-statistics.html">The Comparison class for statistics</a>
    <a class="dropdown-item" href="../articles/stat_review-principal-component-analysis.html">Review of Principal Component Analysis (PCA)</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/donate.html">Donate</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dereckmezquita/dmplot" target="_blank">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.youtube.com/@derecksyoutube" target="_blank">
    <span class="fa fa-youtube fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://derecksnotes.com" target="_blank">derecksnotes.com</a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Principal Component Analysis (PCA) Class</h1>
      <small class="dont-index">Source: <a href="https://github.com/dereckmezquita/dmplot/blob/HEAD/R/Pca.R" class="external-link"><code>R/Pca.R</code></a></small>
      <div class="d-none name"><code>Pca.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The `Pca` class implements Principal Component Analysis, a dimensionality reduction
technique widely used in data analysis and visualisation. This class provides methods
for performing PCA on a dataset, visualising the results, and interpreting the output.</p>
    </div>


    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>PCA is a powerful technique for analysing high-dimensional data, such as gene expression
data in bioinformatics. It works by transforming the data into a new coordinate system
where the axes (principal components) are ordered by the amount of variance they explain.</p>
<p>The PCA process involves several steps:</p>
<p>1. Standardisation:
   PCA begins with a dataset of n-dimensions (in the below demonstration, genes are
   dimensions and samples are observations). The data is standardised, transforming
   each dimension to have a mean of 0 and a standard deviation of 1.</p>
<p>2. Covariance Matrix Computation:
   A covariance matrix is computed. This matrix indicates the covariance
   (shared variance) between each pair of dimensions. The covariance between different
   dimensions is used to understand the correlation structure of the original dimensions.</p>
<p>3. Eigendecomposition:
   The covariance matrix is then decomposed into its eigenvectors and eigenvalues.
   Each eigenvector represents a principal component, which is a linear combination of
   the original dimensions. The associated eigenvalue represents the amount of variance
   explained by the principal component. The eigenvectors are ordered by their corresponding
   eigenvalues, so the first principal component (PC1) explains the most variance, followed by PC2, etc.</p>
<p>4. Selection of Principal Components:
   Depending on the goal of the analysis, some or all of the principal components can
   be selected for further analysis. The 'elbow method' is commonly used, where you plot
   the explained variance by each principal component and look for an 'elbow' in the plot as a cut-off point.</p>
<p>5. Interpretation:
   The 'top rotations' in the context of PCA refer to the features (genes) that contribute
   most to each principal component. The 'rotation' matrix from prcomp() gives the loadings
   of each feature onto each PC. By identifying features with large absolute loadings, we can
   understand what features drive the separation in the data along the principal components.
   In other words, the top rotations tell us which genes are most important for explaining
   the variance in our data along each PC.</p>
<p>This class provides methods for each step of the PCA process, from data preparation
to visualisation of results. It's designed to work with any kind of high-dimensional
numerical data, as long as the data is in a tabular format with features as rows and
samples as columns. The first column must be named "feature" and contain the feature names.</p>
    </div>
    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a></h2>
    <p></p><div class="r6-fields"><dl><dt><code>data</code></dt>
<dd><p>The input data for PCA, typically a data.table with features as rows and samples as columns</p></dd>


<dt><code>comparison</code></dt>
<dd><p>An optional Comparison object for group comparisons</p></dd>


<dt><code>prcomp_results</code></dt>
<dd><p>Results from the stats::prcomp function, containing the raw PCA output</p></dd>


<dt><code>prcomp_refined</code></dt>
<dd><p>Refined PCA results, including percentage of variance explained by each PC</p></dd>


<dt><code>top_rotations</code></dt>
<dd><p>Top contributors (features) to each principal component</p></dd>


<dt><code>scatter</code></dt>
<dd><p>The scatter plot of the first two principal components</p></dd>


<dt><code>scree</code></dt>
<dd><p>The scree plot showing variance explained by each PC</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>
    
<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-Pca-new"><code>Pca$new()</code></a></p></li>
<li><p><a href="#method-Pca-prcomp"><code>Pca$prcomp()</code></a></p></li>
<li><p><a href="#method-Pca-print"><code>Pca$print()</code></a></p></li>
<li><p><a href="#method-Pca-plot_scree"><code>Pca$plot_scree()</code></a></p></li>
<li><p><a href="#method-Pca-plot_scatter"><code>Pca$plot_scatter()</code></a></p></li>
<li><p><a href="#method-Pca-clone"><code>Pca$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-Pca-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Create a new Pca object</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/Pca.html">Pca</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">data</span>, comparison <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>data</code></dt>
<dd><p>A data.table containing the input data for PCA. The first column must be named "feature".</p></dd>


<dt><code>comparison</code></dt>
<dd><p>An optional Comparison object for group comparisons</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-Pca-prcomp"></a><div class="section">
<h3 id="method-prcomp-">Method <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp()</a></code><a class="anchor" aria-label="anchor" href="#method-prcomp-"></a></h3>
<p>Perform Principal Component Analysis on the data</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Pca</span><span class="op">$</span><span class="fu">prcomp</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>...</code></dt>
<dd><p>Additional arguments passed to stats::prcomp</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>NULL (results stored in Pca$prcomp_results, Pca$prcomp_refined)</p>
</div>

</div><p></p><hr><a id="method-Pca-print"></a><div class="section">
<h3 id="method-print-">Method <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code><a class="anchor" aria-label="anchor" href="#method-print-"></a></h3>
<p>Print a summary of the PCA results</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Pca</span><span class="op">$</span><span class="fu">print</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>NULL (prints to console)</p>
</div>

</div><p></p><hr><a id="method-Pca-plot_scree"></a><div class="section">
<h3 id="method-plot-scree-">Method <code>plot_scree()</code><a class="anchor" aria-label="anchor" href="#method-plot-scree-"></a></h3>
<p>Generate a scree plot of the PCA results</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Pca</span><span class="op">$</span><span class="fu">plot_scree</span><span class="op">(</span>num_pc <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>num_pc</code></dt>
<dd><p>Number of principal components to include in the plot</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p>A ggplot2 object representing the scree plot</p>
</div>

</div><p></p><hr><a id="method-Pca-plot_scatter"></a><div class="section">
<h3 id="method-plot-scatter-">Method <code>plot_scatter()</code><a class="anchor" aria-label="anchor" href="#method-plot-scatter-"></a></h3>
<p>Generate a scatter plot of the first two principal components</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Pca</span><span class="op">$</span><span class="fu">plot_scatter</span><span class="op">(</span></span>
<span>  point_default_colour <span class="op">=</span> <span class="st">"grey"</span>,</span>
<span>  point_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  point_alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  point_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>show <span class="op">=</span> <span class="cn">TRUE</span>, size <span class="op">=</span> <span class="fl">4</span>, max_overlaps <span class="op">=</span> <span class="fl">10</span>, alpha <span class="op">=</span> <span class="fl">0.75</span>, font_face <span class="op">=</span></span>
<span>    <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>  top_contributors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>show <span class="op">=</span> <span class="cn">TRUE</span>, truncate <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>,</span>
<span>  title <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">self</span><span class="op">$</span><span class="va">comparison</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_interp.html" class="external-link">str_interp</a></span><span class="op">(</span><span class="st">"${self$comparison$comparison_name}: principal components 1 and 2"</span><span class="op">)</span></span>
<span>    <span class="kw">else</span> <span class="st">"Principal components 1 and 2"</span>,</span>
<span>  subtitle <span class="op">=</span></span>
<span>    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_interp.html" class="external-link">str_interp</a></span><span class="op">(</span><span class="st">"${nrow(self$prcomp_results$x)} samples, ${ncol(self$prcomp_results$rotation)} principal components, calculated from ${nrow(self$prcomp_results$rotation)} features"</span><span class="op">)</span>,</span>
<span>  caption <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="va">top_contributors</span><span class="op">$</span><span class="va">show</span><span class="op">)</span></span>
<span>    <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_interp.html" class="external-link">str_interp</a></span><span class="op">(</span><span class="st">"Top contributors to variance:\nPC1: ${paste0(stringr::str_trunc(names(self$top_rotations$PC1), top_contributors$truncate), collapse = \", \")}\nPC2: ${paste0(stringr::str_trunc(names(self$top_rotations$PC2), top_contributors$truncate), collapse = \", \")}"</span><span class="op">)</span></span>
<span>    <span class="kw">else</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>point_default_colour</code></dt>
<dd><p>Default colour for points when no comparison is provided</p></dd>


<dt><code>point_size</code></dt>
<dd><p>Size of the points in the scatter plot</p></dd>


<dt><code>point_alpha</code></dt>
<dd><p>Alpha (transparency) of the points</p></dd>


<dt><code>point_labels</code></dt>
<dd><p>List of parameters for point labels</p></dd>


<dt><code>top_contributors</code></dt>
<dd><p>List of parameters for displaying top contributors</p></dd>


<dt><code>title</code></dt>
<dd><p>Title of the plot</p></dd>


<dt><code>subtitle</code></dt>
<dd><p>Subtitle of the plot</p></dd>


<dt><code>caption</code></dt>
<dd><p>Caption of the plot</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a></h4>
<p>A ggplot2 object representing the scatter plot
Filter samples based on a comparison object
Refine PCA results for easier interpretation
Prepare data for PCA by dropping non-numerical columns</p>
</div>

</div><p></p><hr><a id="method-Pca-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">Pca</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load required packages</span></span></span>
<span class="r-in"><span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span><span class="va">dmplot</span><span class="op">[</span><span class="va">Pca</span>, <span class="va">Comparison</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">feature_counts</span>, package <span class="op">=</span> <span class="st">"dmplot"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Prepare the data</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">feature_counts</span><span class="op">[</span><span class="va">GeneBiotype</span> <span class="op">==</span> <span class="st">"protein_coding"</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"feature"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a comparison table</span></span></span>
<span class="r-in"><span><span class="va">comp_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"T64552"</span>, <span class="st">"T64553"</span>, <span class="st">"T64554"</span>, <span class="st">"T64555"</span>, <span class="st">"T64546"</span>, <span class="st">"T64548"</span>, <span class="st">"T64549"</span>, <span class="st">"T64550"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a Comparison object</span></span></span>
<span class="r-in"><span><span class="va">comp</span> <span class="op">&lt;-</span> <span class="va"><a href="Comparison.html">Comparison</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>    comparison_name <span class="op">=</span> <span class="st">"A_over_B"</span>,</span></span>
<span class="r-in"><span>    group_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"A"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    comparison_table <span class="op">=</span> <span class="va">comp_table</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> A_over_B: deriving condition "control", "test" from group_order argument: control - B, test - A</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a Pca object</span></span></span>
<span class="r-in"><span><span class="va">pca_obj</span> <span class="op">&lt;-</span> <span class="va">Pca</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">data</span>, <span class="va">comp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform PCA</span></span></span>
<span class="r-in"><span><span class="va">pca_obj</span><span class="op">$</span><span class="fu">prcomp</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access PCA results</span></span></span>
<span class="r-in"><span><span class="va">pca_obj</span><span class="op">$</span><span class="va">data</span>                <span class="co"># View the input data</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   feature T64555 T64550 T64554 T64546 T64548 T64553 T64549</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    &lt;char&gt;  &lt;num&gt;  &lt;num&gt;  &lt;num&gt;  &lt;num&gt;  &lt;num&gt;  &lt;num&gt;  &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1: ENSMUSG00000051845     11      4     26      9      6     30     10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2: ENSMUSG00000025374    366   1036    377    933    702    483   1103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3: ENSMUSG00000025609    630   2005    729   1793   1788    587   1571</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4: ENSMUSG00000033608   1099    930    960    898   1045   1234    881</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5: ENSMUSG00000025916   1198   1179   1474   1227   1219   1302   1111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ---                                                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21932: ENSMUSG00000079777      0      0      0      0      0      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21933: ENSMUSG00000095325      0      1      0      0      0      0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21934: ENSMUSG00000063958      0      1      0      0      0      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21935: ENSMUSG00000096294      0      0      1      0      0      2      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21936: ENSMUSG00000095261      0      0      2      0      0      0      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        T64552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1:     22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2:    298</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3:   1190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4:    992</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5:   1224</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ---       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21932:      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21933:      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21934:      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21935:      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21936:      0</span>
<span class="r-in"><span><span class="va">pca_obj</span><span class="op">$</span><span class="va">prcomp_results</span>      <span class="co"># View the raw PCA results</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard deviations (1, .., p=8):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.138674e+06 8.773857e+04 6.518402e+04 4.366182e+04 2.366213e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [6] 2.021359e+04 1.856779e+04 5.074559e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rotation (n x k) = (21936 x 9):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   feature           PC1           PC2           PC3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    &lt;char&gt;         &lt;num&gt;         &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1: ENSMUSG00000051845 -7.096769e-06 -3.435085e-06 -1.311560e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2: ENSMUSG00000025374  2.507594e-04  2.327624e-04 -2.263580e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3: ENSMUSG00000025609  4.829978e-04  5.629973e-04 -1.712018e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4: ENSMUSG00000033608 -5.838886e-05 -4.247061e-04  4.967849e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5: ENSMUSG00000025916 -4.793845e-05 -2.682115e-04  4.364476e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ---                                                             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21932: ENSMUSG00000079777  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21933: ENSMUSG00000095325  2.104848e-07  9.823465e-07 -5.164060e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21934: ENSMUSG00000063958  1.452822e-07 -1.861195e-06 -1.868383e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21935: ENSMUSG00000096294 -3.440474e-07 -2.470131e-06 -1.668852e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21936: ENSMUSG00000095261 -2.224891e-07  5.361425e-07  8.268138e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  PC4           PC5           PC6           PC7           PC8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                &lt;num&gt;         &lt;num&gt;         &lt;num&gt;         &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1:  5.189112e-05  1.801555e-04 -1.200291e-04 -5.108678e-05  9.958967e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2: -8.527113e-04  7.442109e-04 -1.801072e-04  1.408829e-03  1.440055e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3:  3.257467e-03 -4.084275e-03 -2.342402e-04 -1.156612e-03  1.229453e-03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4: -1.161698e-03  1.980618e-04 -3.013515e-03 -1.493341e-03  5.472309e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5:  6.001607e-04  3.090540e-03  1.550082e-03 -9.226412e-04 -6.659177e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    ---                                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21932:  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21933: -1.229342e-06 -3.660716e-06  3.726451e-06 -7.625355e-06 -8.576584e-09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21934:  8.114471e-07 -4.150045e-06  4.075928e-06 -1.056032e-05 -1.770769e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21935: -2.191337e-06  2.016344e-05 -1.332807e-05 -9.622857e-06 -2.664305e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21936:  3.340294e-06  1.866922e-05  2.224219e-05 -5.936117e-06 -9.170773e-08</span>
<span class="r-in"><span><span class="va">pca_obj</span><span class="op">$</span><span class="va">prcomp_refined</span>      <span class="co"># View the refined PCA results</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        PC pct_var_explained        T64555        T64550        T64554</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    &lt;fctr&gt;             &lt;num&gt;         &lt;num&gt;         &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:    PC1             98.84 -1.095036e+06  1.318588e+06 -1.009661e+06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:    PC2              0.59 -4.006736e+04 -1.002931e+05  1.444540e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:    PC3              0.32  2.585091e+04 -5.557073e+04  1.229583e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:    PC4              0.15 -6.332709e+04  1.082834e+04  2.228724e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:    PC5              0.04 -3.031154e+04 -1.626517e+04  3.658489e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:    PC6              0.03  1.610595e+04  1.165766e+04  3.180771e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7:    PC7              0.03  1.252223e+04 -2.548565e+04 -7.162936e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8:    PC8              0.00 -7.304681e-10  1.467666e-10 -7.570011e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           T64546        T64548        T64553        T64549        T64552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            &lt;num&gt;         &lt;num&gt;         &lt;num&gt;         &lt;num&gt;         &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:  1.106923e+06  1.171230e+06 -1.056464e+06  5.917810e+05 -1.027361e+06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2: -7.521318e+04  6.485800e+04 -7.377593e+04  1.532282e+05  5.681796e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:  9.713139e+03  1.223412e+05 -3.096599e+04 -9.802232e+04  1.435798e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:  3.058937e+04 -2.366272e+04 -2.576475e+04 -2.723327e+04  7.628288e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:  1.055647e+04  4.748593e+03  2.122058e+04  1.917814e+03 -2.845164e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6: -2.616935e+03 -9.385638e+03 -3.496382e+04 -9.995481e+02 -1.160537e+04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7:  3.579439e+04 -1.243312e+04 -8.030147e+03  7.083070e+03 -2.287841e+03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8: -5.251044e-10 -1.228349e-09  1.467524e-09  1.514077e-09  1.135242e-10</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create visualisations</span></span></span>
<span class="r-in"><span><span class="va">scree_plot</span> <span class="op">&lt;-</span> <span class="va">pca_obj</span><span class="op">$</span><span class="fu">plot_scree</span><span class="op">(</span><span class="op">)</span>    <span class="co"># Generate a scree plot</span></span></span>
<span class="r-in"><span><span class="va">scatter_plot</span> <span class="op">&lt;-</span> <span class="va">pca_obj</span><span class="op">$</span><span class="fu">plot_scatter</span><span class="op">(</span><span class="op">)</span> <span class="co"># Generate a scatter plot</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Print the scree plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scree_plot</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Pca-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Print the scatter plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">scatter_plot</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="Pca-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://derecksnotes.com" class="external-link">Dereck Mezquita</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

