[{"path":"https://dereckmezquita.github.io/dmplot/articles/getting-started-with-the-dmplot-framwork.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting started with the dmplot framework","text":"vignette explain conventions dmplot design choices - guide working data effectively leveraging dmplot ggplot2 framework derive insight analyses. dmplot limited financial data, indeed ’s conventions design choices applicable time series data. However, package indeed focus financial data analysis visualisation.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/articles/getting-started-with-the-dmplot-framwork.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Getting started with the dmplot framework","text":"Let’s install necessary libraries. often use following packages: data.table working large datasets. dmplot plotting financial time series datasets. kucoin interacting KuCoin API - getting cryptocurrency financial data. ggplot2 plotting. box loading modules R. strongly recommend using data.table work finance. indeed one primary reasons data.table created - work large datasets efficiently. installing data.table M1 MacOS consult guide building source: gist.github.com/dereckmezquita/ed860601138a46cf591a1bdcc95db0a2 Now, let’s load required libraries:","code":"install.packages(\"data.table\", type = \"source\") install.packages(\"TTR\") install.packages(\"ggplot2\") install.packages(\"box\")  remotes::install_github(\"dereckmezquita/dmplot\") remotes::install_github(\"dereckmezquita/kucoin\") box::use(kucoin) box::use(dt = data.table)"},{"path":"https://dereckmezquita.github.io/dmplot/articles/getting-started-with-the-dmplot-framwork.html","id":"dmplot-and-tidy-data-for-financial-data-analysis-and-visualization","dir":"Articles","previous_headings":"","what":"dmplot and “Tidy Data” for Financial Data Analysis and Visualization","title":"Getting started with the dmplot framework","text":"dmplot package provides toolkit plotting financial time series datasets ggplot2 framework. includes functions plotting candlestick charts, moving averages, Bollinger Bands, MACD, RSI, Stochastic Oscillator. order best leverage ggplot2 , thus visualise financial analyses must adhere “tidy data” convention. Whereby column variable, row observation, cell single value. format dmplot expects. Thus, calculated indicators added new columns dataset dmplot expects. offer two points guidance: Use data.table. Functions must return named list values. reason first point data.table powerful package working large datasets highly efficient. second point return named list values can easily use function within data.table create new columns. can see sticking convention allows us easily efficiently leverage data.table framework calculate new columns thus new indicators.","code":"petal_ratios <- function(petal_length, petal_width, sepal_length, sepal_width) {     petal_ratio <- petal_length / petal_width     sepal_ratio <- sepal_length / sepal_width     return(list(petal_ratio = petal_ratio, sepal_ratio = sepal_ratio)) }  iris2 <- dt$as.data.table(iris)  head(iris2) #>    Sepal.Length Sepal.Width Petal.Length Petal.Width Species #>           <num>       <num>        <num>       <num>  <fctr> #> 1:          5.1         3.5          1.4         0.2  setosa #> 2:          4.9         3.0          1.4         0.2  setosa #> 3:          4.7         3.2          1.3         0.2  setosa #> 4:          4.6         3.1          1.5         0.2  setosa #> 5:          5.0         3.6          1.4         0.2  setosa #> 6:          5.4         3.9          1.7         0.4  setosa iris2[,     c(\"petal_ratio\", \"sepal_ratio\") := petal_ratios(         Petal.Length,         Petal.Width,         Sepal.Length,         Sepal.Width     ) ]  head(iris2) #>    Sepal.Length Sepal.Width Petal.Length Petal.Width Species petal_ratio #>           <num>       <num>        <num>       <num>  <fctr>       <num> #> 1:          5.1         3.5          1.4         0.2  setosa        7.00 #> 2:          4.9         3.0          1.4         0.2  setosa        7.00 #> 3:          4.7         3.2          1.3         0.2  setosa        6.50 #> 4:          4.6         3.1          1.5         0.2  setosa        7.50 #> 5:          5.0         3.6          1.4         0.2  setosa        7.00 #> 6:          5.4         3.9          1.7         0.4  setosa        4.25 #> 1 variable(s) not shown: [sepal_ratio <num>]"},{"path":"https://dereckmezquita.github.io/dmplot/articles/getting-started-with-the-dmplot-framwork.html","id":"loading-sample-data","dir":"Articles","previous_headings":"","what":"Loading Sample Data","title":"Getting started with the dmplot framework","text":"’ll use sample data README:","code":"ticker <- \"BTC/USDT\"  dt <- kucoin$get_market_data(     symbols = ticker,     from = \"2024-06-30 11:34:17 EST\", # lubridate::now() - lubridate::days(7),     to = \"2024-07-07 11:34:12 EST\", # lubridate::now(),     frequency = \"1 hour\" )  head(dt) #>      symbol            datetime    open    high     low   close   volume #>      <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #> 1: BTC/USDT 2024-06-30 11:00:00 61540.9 61665.8 61518.7 61553.3 43.87309 #> 2: BTC/USDT 2024-06-30 12:00:00 61553.3 61654.9 61333.0 61490.7 63.42409 #> 3: BTC/USDT 2024-06-30 13:00:00 61490.8 61740.9 61451.1 61711.7 52.80176 #> 4: BTC/USDT 2024-06-30 14:00:00 61711.7 61846.7 61526.1 61581.7 89.92135 #> 5: BTC/USDT 2024-06-30 15:00:00 61581.7 61775.6 61580.9 61717.4 34.02352 #> 6: BTC/USDT 2024-06-30 16:00:00 61719.7 61749.6 61578.4 61601.8 27.14692 #> 1 variable(s) not shown: [turnover <num>]"},{"path":"https://dereckmezquita.github.io/dmplot/articles/getting-started-with-the-dmplot-framwork.html","id":"calculating-financial-indicators","dir":"Articles","previous_headings":"","what":"Calculating Financial Indicators","title":"Getting started with the dmplot framework","text":"provide host functions calculating financial indicators dmplot package. functions designed used within data.table framework return named list values. However, find need use outside functions can easily wrap function returns named list values. demonstrate TTT::EMA TTT::BBands:","code":"box::use(TTR[EMA, BBands])  # redifine our function to return a list ema <- function(x, n, wilder = TRUE) {     return(as.list(as.data.frame(EMA(x, n = n, wilder = wilder)))) }  bb <- function(close, n = 2, sd = 2) {     return(as.list(as.data.frame(BBands(close, n = n, sd = sd)))) }  # calculate the short and long moving averages dt[, ema_short := ema(close, n = 10, wilder = TRUE)] dt[, ema_long := ema(close, n = 50, wilder = TRUE)]  # calculate the bollinger bands dt[,     c(\"bb_lower\", \"bb_mavg\", \"bb_upper\", \"bb_pct\") := bb(         close, n = 10,         sd = 2     ) ]  head(dt) #>      symbol            datetime    open    high     low   close   volume #>      <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #> 1: BTC/USDT 2024-06-30 11:00:00 61540.9 61665.8 61518.7 61553.3 43.87309 #> 2: BTC/USDT 2024-06-30 12:00:00 61553.3 61654.9 61333.0 61490.7 63.42409 #> 3: BTC/USDT 2024-06-30 13:00:00 61490.8 61740.9 61451.1 61711.7 52.80176 #> 4: BTC/USDT 2024-06-30 14:00:00 61711.7 61846.7 61526.1 61581.7 89.92135 #> 5: BTC/USDT 2024-06-30 15:00:00 61581.7 61775.6 61580.9 61717.4 34.02352 #> 6: BTC/USDT 2024-06-30 16:00:00 61719.7 61749.6 61578.4 61601.8 27.14692 #> 7 variable(s) not shown: [turnover <num>, ema_short <num>, ema_long <num>, bb_lower <num>, bb_mavg <num>, bb_upper <num>, bb_pct <num>]"},{"path":"https://dereckmezquita.github.io/dmplot/articles/intro-to-financial-indicators-with-dmplot.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Introduction to financial indicators with dmplot","text":"vignette explains calculate interpret common financial indicators used technical analysis. ’ll cover mathematics behind indicator demonstrate functions used calculate well leverage provided dmplot. Finally, ’ll demonstrate visualise indicators using dmplot package.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/articles/intro-to-financial-indicators-with-dmplot.html","id":"setup","dir":"Articles","previous_headings":"","what":"Setup","title":"Introduction to financial indicators with dmplot","text":"See getting started installing recommended libraries: Getting Started dmplot Framework","code":"box::use(kucoin) box::use(dt = data.table) box::use(ggplot2) box::use(dmplot)"},{"path":"https://dereckmezquita.github.io/dmplot/articles/intro-to-financial-indicators-with-dmplot.html","id":"loading-sample-data","dir":"Articles","previous_headings":"","what":"Loading Sample Data","title":"Introduction to financial indicators with dmplot","text":"’ll use sample data README:","code":"ticker <- \"BTC/USDT\"  data <- kucoin$get_market_data(     symbols = ticker,     from = \"2024-06-30 11:34:17 EST\", # lubridate::now() - lubridate::days(7),     to = \"2024-07-07 11:34:12 EST\", # lubridate::now(),     frequency = \"1 hour\" )  head(data) #>      symbol            datetime    open    high     low   close   volume #>      <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #> 1: BTC/USDT 2024-06-30 11:00:00 61540.9 61665.8 61518.7 61553.3 43.87309 #> 2: BTC/USDT 2024-06-30 12:00:00 61553.3 61654.9 61333.0 61490.7 63.42409 #> 3: BTC/USDT 2024-06-30 13:00:00 61490.8 61740.9 61451.1 61711.7 52.80176 #> 4: BTC/USDT 2024-06-30 14:00:00 61711.7 61846.7 61526.1 61581.7 89.92135 #> 5: BTC/USDT 2024-06-30 15:00:00 61581.7 61775.6 61580.9 61717.4 34.02352 #> 6: BTC/USDT 2024-06-30 16:00:00 61719.7 61749.6 61578.4 61601.8 27.14692 #> 1 variable(s) not shown: [turnover <num>]"},{"path":"https://dereckmezquita.github.io/dmplot/articles/intro-to-financial-indicators-with-dmplot.html","id":"calculating-and-visualising-financial-indicators","dir":"Articles","previous_headings":"","what":"Calculating and Visualising Financial Indicators","title":"Introduction to financial indicators with dmplot","text":"adhere “Tidy Data” principles ggplot2 framework can easily calculate build visualisations layers. first set create set base layers reuse throughout visualisations.","code":""},{"path":[]},{"path":"https://dereckmezquita.github.io/dmplot/articles/intro-to-financial-indicators-with-dmplot.html","id":"candlestick-chart","dir":"Articles","previous_headings":"Calculating and Visualising Financial Indicators > Base Layers","what":"Candlestick Chart","title":"Introduction to financial indicators with dmplot","text":"candlestick chart type financial chart used represent price movements security. candlestick typically shows open, high, low, close prices specific period.","code":"candle_plot <- data |>     ggplot2$ggplot(ggplot2$aes(         x = datetime,         open = open,         high = high,         low = low,         close = close     )) +     ## ------------------------------------     dmplot$stat_candlestick() +     ## ------------------------------------     ggplot2$scale_x_datetime(date_breaks = \"1 day\", date_labels = \"%b %d\") +     ggplot2$labs(         title = paste(ticker, \"- Candlestick with EMA and Bollinger Bands\"),         x = \"Date\",         y = \"Price (USD)\"     ) +     dmplot$theme_dereck_dark() +     ggplot2$theme(axis.text.x = ggplot2$element_text(angle = 45, hjust = 1))  print(candle_plot)"},{"path":"https://dereckmezquita.github.io/dmplot/articles/intro-to-financial-indicators-with-dmplot.html","id":"line-chart","dir":"Articles","previous_headings":"Calculating and Visualising Financial Indicators > Base Layers","what":"Line Chart","title":"Introduction to financial indicators with dmplot","text":"Sometimes may want visualise single indicator price movement time. line chart simple effective way .","code":"line_plot <- data |>     ggplot2$ggplot(ggplot2$aes(         x = datetime,         y = close     )) +     ggplot2$geom_line(         colour = \"cyan\",         linewidth = 1.25,         alpha = 0.5,         na.rm = TRUE     ) +     ggplot2$scale_x_datetime(date_breaks = \"1 day\", date_labels = \"%b %d\") +     ggplot2$labs(         title = paste(ticker, \"- Closing Price\"),         x = \"Date\",         y = \"Price (USD)\"     ) +     dmplot$theme_dereck_dark() +     ggplot2$theme(axis.text.x = ggplot2$element_text(angle = 45, hjust = 1))  print(line_plot)"},{"path":"https://dereckmezquita.github.io/dmplot/articles/intro-to-financial-indicators-with-dmplot.html","id":"volume","dir":"Articles","previous_headings":"Calculating and Visualising Financial Indicators > Base Layers","what":"Volume","title":"Introduction to financial indicators with dmplot","text":"volume indicator financial indicator per se, commonly used conjunction indicators confirm price trends.","code":"volume_plot <- data |>     ggplot2$ggplot(ggplot2$aes(         x = datetime,         y = volume,         group = symbol     )) +     ggplot2$geom_bar(         stat = \"identity\",         ggplot2$aes(fill = ifelse(close > open, \"green\", \"red\")),         linewidth = 1,         alpha = 1,         na.rm = TRUE     ) +     ggplot2$scale_x_datetime(         date_breaks = \"1 day\",         date_minor_breaks = \"1 hour\",         date_labels = \"%d %b\"     ) +     ggplot2$scale_fill_identity() +     ggplot2$labs(         x = ggplot2$element_blank(),         y = \"Volume\"     ) +     dmplot$theme_dereck_dark() +     ggplot2$theme(         axis.text.x = ggplot2$element_text(angle = 45, hjust = 1),         panel.grid.minor = ggplot2::element_blank()     )  print(volume_plot)"},{"path":"https://dereckmezquita.github.io/dmplot/articles/intro-to-financial-indicators-with-dmplot.html","id":"simple-moving-average-sma","dir":"Articles","previous_headings":"Calculating and Visualising Financial Indicators","what":"1. Simple Moving Average (SMA)","title":"Introduction to financial indicators with dmplot","text":"Simple Moving Average (SMA) average security’s price specified number periods. Mathematics: series Y, SMA time t calculated : SMA(t)=Y(t)+Y(t−1)+...+Y(t−n+1)n SMA(t) = \\frac{Y(t) + Y(t-1) + ... + Y(t-n+1)}{n} n number periods. Now using candlestick plot created earlier, can add SMA layer visualise moving averages.","code":"sma <- function(x, n) {     return(as.list(as.data.frame(TTR::SMA(x, n = n)))) }  data2 <- dt$copy(data)  data2[, sma_short := sma(close, n = 20)[[1]]] data2[, sma_long := sma(close, n = 50)[[1]]]  head(data2) #>      symbol            datetime    open    high     low   close   volume #>      <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #> 1: BTC/USDT 2024-06-30 11:00:00 61540.9 61665.8 61518.7 61553.3 43.87309 #> 2: BTC/USDT 2024-06-30 12:00:00 61553.3 61654.9 61333.0 61490.7 63.42409 #> 3: BTC/USDT 2024-06-30 13:00:00 61490.8 61740.9 61451.1 61711.7 52.80176 #> 4: BTC/USDT 2024-06-30 14:00:00 61711.7 61846.7 61526.1 61581.7 89.92135 #> 5: BTC/USDT 2024-06-30 15:00:00 61581.7 61775.6 61580.9 61717.4 34.02352 #> 6: BTC/USDT 2024-06-30 16:00:00 61719.7 61749.6 61578.4 61601.8 27.14692 #> 3 variable(s) not shown: [turnover <num>, sma_short <num>, sma_long <num>] sma_layer <- dmplot$stat_movingaverages(data = data2,         ggplot2$aes(x = datetime, short = sma_short, long = sma_long),         alpha = list(mavg = 0.5)     )  print(candle_plot + sma_layer)"},{"path":[]},{"path":"https://dereckmezquita.github.io/dmplot/articles/intro-to-financial-indicators-with-dmplot.html","id":"exponential-moving-average-ema","dir":"Articles","previous_headings":"Calculating and Visualising Financial Indicators","what":"1. Exponential Moving Average (EMA)","title":"Introduction to financial indicators with dmplot","text":"EMA gives weight recent prices, making responsive new information simple moving average. Mathematics: series Y, EMA time t calculated : EMA(t)=α*Y(t)+(1−α)*EMA(t−1) EMA(t) = α * Y(t) + (1 - α) * EMA(t-1) α = 2 / (N + 1), N number periods.","code":"ema <- function(x, n, wilder = TRUE) {     as.list(as.data.frame(TTR::EMA(x, n = n, wilder = wilder))) }  data2 <- dt$copy(data)  data2[, `:=`(     ema_short = ema(close, n = 10, wilder = TRUE)[[1]],     ema_long = ema(close, n = 50, wilder = TRUE)[[1]] )]  head(data2) #>      symbol            datetime    open    high     low   close   volume #>      <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #> 1: BTC/USDT 2024-06-30 11:00:00 61540.9 61665.8 61518.7 61553.3 43.87309 #> 2: BTC/USDT 2024-06-30 12:00:00 61553.3 61654.9 61333.0 61490.7 63.42409 #> 3: BTC/USDT 2024-06-30 13:00:00 61490.8 61740.9 61451.1 61711.7 52.80176 #> 4: BTC/USDT 2024-06-30 14:00:00 61711.7 61846.7 61526.1 61581.7 89.92135 #> 5: BTC/USDT 2024-06-30 15:00:00 61581.7 61775.6 61580.9 61717.4 34.02352 #> 6: BTC/USDT 2024-06-30 16:00:00 61719.7 61749.6 61578.4 61601.8 27.14692 #> 3 variable(s) not shown: [turnover <num>, ema_short <num>, ema_long <num>] ema_layer <- dmplot$stat_movingaverages(data = data2,         ggplot2$aes(x = datetime, short = ema_short, long = ema_long),         alpha = list(mavg = 0.5),         colour = list(\"cyan\", \"magenta\")     )  print(candle_plot + ema_layer)"},{"path":"https://dereckmezquita.github.io/dmplot/articles/intro-to-financial-indicators-with-dmplot.html","id":"bollinger-bands","dir":"Articles","previous_headings":"Calculating and Visualising Financial Indicators","what":"2. Bollinger Bands","title":"Introduction to financial indicators with dmplot","text":"Bollinger Bands consist middle band (usually simple moving average) upper lower band standard deviations away middle band. Mathematics: MiddleBand=SMA(n) Middle Band = SMA(n) UpperBand=SMA(n)+k*σ(n) Upper Band = SMA(n) + k * σ(n) LowerBand=SMA(n)−k*σ(n) Lower Band = SMA(n) - k * σ(n) SMA(n) n-period simple moving average, σ(n) n-period standard deviation, k number standard deviations (usually 2). can see plot Bolllinger Bands great way visualise price volatility see security overbought oversold.","code":"bb <- function(close, n = 20, sd = 2) {     as.list(as.data.frame(TTR::BBands(close, n = n, sd = sd))) }  data2 <- dt$copy(data)  data2[, c(\"bb_lower\", \"bb_mavg\", \"bb_upper\", \"bb_pct\") := bb(close, n = 10, sd = 2)]  head(data2) #>      symbol            datetime    open    high     low   close   volume #>      <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #> 1: BTC/USDT 2024-06-30 11:00:00 61540.9 61665.8 61518.7 61553.3 43.87309 #> 2: BTC/USDT 2024-06-30 12:00:00 61553.3 61654.9 61333.0 61490.7 63.42409 #> 3: BTC/USDT 2024-06-30 13:00:00 61490.8 61740.9 61451.1 61711.7 52.80176 #> 4: BTC/USDT 2024-06-30 14:00:00 61711.7 61846.7 61526.1 61581.7 89.92135 #> 5: BTC/USDT 2024-06-30 15:00:00 61581.7 61775.6 61580.9 61717.4 34.02352 #> 6: BTC/USDT 2024-06-30 16:00:00 61719.7 61749.6 61578.4 61601.8 27.14692 #> 5 variable(s) not shown: [turnover <num>, bb_lower <num>, bb_mavg <num>, bb_upper <num>, bb_pct <num>] bb_layer <- dmplot$stat_bollingerbands(data = data2,         ggplot2$aes(ymin = bb_lower, mavg = bb_mavg, ymax = bb_upper),         colour = list(\"pink\", \"cyan\", \"cyan\")     )  print(candle_plot + bb_layer)"},{"path":"https://dereckmezquita.github.io/dmplot/articles/intro-to-financial-indicators-with-dmplot.html","id":"moving-average-convergence-divergence-macd","dir":"Articles","previous_headings":"Calculating and Visualising Financial Indicators","what":"3. Moving Average Convergence Divergence (MACD)","title":"Introduction to financial indicators with dmplot","text":"MACD trend-following momentum indicator shows relationship two moving averages security’s price. Mathematics: MACDLine=EMA(12)−EMA(26) MACD Line = EMA(12) - EMA(26) SignalLine=EMA(9)ofMACDLine Signal Line = EMA(9) MACD Line MACDHistogram=MACDLine−SignalLine MACD Histogram = MACD Line - Signal Line MACD Line difference short-term EMA (12 periods) long-term EMA (26 periods). Signal Line EMA MACD Line (usually 9 periods). MACD Line crosses Signal Line, considered bullish signal. MACD Line crosses Signal Line, considered bearish signal. can see plot , MACD indicator great way visualise relationship two moving averages identify potential buy sell signals. plot shows two moving averages MACD histogram; histogram difference MACD Line Signal Line.","code":"macd <- function(x, fast = 12, slow = 26, signal = 9) {     as.list(as.data.frame(TTR::MACD(x, fast, slow, signal))) }  data2 <- dt$copy(data)  data2[, c(\"macd\", \"macd_signal\") := macd(close, fast = 12, slow = 26, signal = 9)] data2[, macd_diff := macd - macd_signal]  head(data2) #>      symbol            datetime    open    high     low   close   volume #>      <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #> 1: BTC/USDT 2024-06-30 11:00:00 61540.9 61665.8 61518.7 61553.3 43.87309 #> 2: BTC/USDT 2024-06-30 12:00:00 61553.3 61654.9 61333.0 61490.7 63.42409 #> 3: BTC/USDT 2024-06-30 13:00:00 61490.8 61740.9 61451.1 61711.7 52.80176 #> 4: BTC/USDT 2024-06-30 14:00:00 61711.7 61846.7 61526.1 61581.7 89.92135 #> 5: BTC/USDT 2024-06-30 15:00:00 61581.7 61775.6 61580.9 61717.4 34.02352 #> 6: BTC/USDT 2024-06-30 16:00:00 61719.7 61749.6 61578.4 61601.8 27.14692 #> 4 variable(s) not shown: [turnover <num>, macd <num>, macd_signal <num>, macd_diff <num>] macd_plot <- data2 |>     ggplot2$ggplot(ggplot2$aes(x = datetime)) +     dmplot$stat_macd(data = data2,         ggplot2$aes(macd = macd, macd_signal = macd_signal, macd_diff = macd_diff)     ) +     dmplot$theme_dereck_dark() +     ggplot2$scale_x_datetime(date_breaks = \"1 day\", date_labels = \"%b %d\") +     ggplot2$labs(         title = paste(ticker, \"- MACD\"),         x = \"Date\",         y = \"MACD Value\"     ) +     ggplot2$theme(axis.text.x = ggplot2$element_text(angle = 45, hjust = 1))  print(macd_plot)"},{"path":"https://dereckmezquita.github.io/dmplot/articles/intro-to-financial-indicators-with-dmplot.html","id":"relative-strength-index-rsi","dir":"Articles","previous_headings":"Calculating and Visualising Financial Indicators","what":"4. Relative Strength Index (RSI)","title":"Introduction to financial indicators with dmplot","text":"RSI momentum oscillator measures speed change price movements. Mathematics: RSI=100−(100/(1+RS)) RSI = 100 - (100 / (1 + RS)) RS = Average Gain / Average Loss AverageGain=[(previousavg.gain)x13+currentgain]/14 Average Gain = [(previous avg. gain) x 13 + current gain] / 14 AverageLoss=[(previousavg.loss)x13+currentloss]/14 Average Loss = [(previous avg. loss) x 13 + current loss] / 14 RSI provides visual representation strength security’s price movement. often used identify overbought oversold conditions.","code":"rsi <- function(x, n = 14) {     as.list(as.data.frame(TTR::RSI(x, n = n))) }  data2 <- dt$copy(data)  data2[, rsi := rsi(close, n = 14)[[1]]]  head(data2) #>      symbol            datetime    open    high     low   close   volume #>      <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #> 1: BTC/USDT 2024-06-30 11:00:00 61540.9 61665.8 61518.7 61553.3 43.87309 #> 2: BTC/USDT 2024-06-30 12:00:00 61553.3 61654.9 61333.0 61490.7 63.42409 #> 3: BTC/USDT 2024-06-30 13:00:00 61490.8 61740.9 61451.1 61711.7 52.80176 #> 4: BTC/USDT 2024-06-30 14:00:00 61711.7 61846.7 61526.1 61581.7 89.92135 #> 5: BTC/USDT 2024-06-30 15:00:00 61581.7 61775.6 61580.9 61717.4 34.02352 #> 6: BTC/USDT 2024-06-30 16:00:00 61719.7 61749.6 61578.4 61601.8 27.14692 #> 2 variable(s) not shown: [turnover <num>, rsi <num>] rsi_plot <- na.omit(data2) |>     ggplot2$ggplot(ggplot2$aes(x = datetime)) +     ggplot2$geom_line(ggplot2$aes(y = rsi, colour = \"RSI\")) +     ggplot2$geom_hline(         yintercept = c(30, 70),         linetype = \"dashed\",         colour = \"yellow\"     ) +     ggplot2$scale_x_datetime(date_breaks = \"1 day\", date_labels = \"%b %d\") +     ggplot2$scale_y_continuous(limits = c(0, 100)) +     ggplot2$scale_color_manual(values = c(\"RSI\" = \"cyan\")) +     ggplot2$labs(         title = paste(ticker, \"- RSI\"),         x = \"Date\",         y = \"RSI Value\"     ) +     dmplot$theme_dereck_dark() +     ggplot2$theme(         axis.text.x = ggplot2$element_text(angle = 45, hjust = 1),         legend.position = \"none\"     )  print(rsi_plot)"},{"path":"https://dereckmezquita.github.io/dmplot/articles/intro-to-financial-indicators-with-dmplot.html","id":"rate-of-change-roc-momentum","dir":"Articles","previous_headings":"Calculating and Visualising Financial Indicators","what":"5. Rate of Change (ROC) / Momentum","title":"Introduction to financial indicators with dmplot","text":"Rate Change (ROC) indicator measures percentage change price current price price n periods ago. Mathematics: ROC=Close−ClosenClosen ROC = \\frac{Close - Close_{n}}{Close_{n}} n number periods. often used momentum indicator identify overbought oversold conditions. Notice execute second calculation normalise momentum values -1 1. Momentum=ROCmax(|ROC|) Momentum = \\frac{ROC}{max(|ROC|)} Momentum indicator simple way visualise rate change price specified number periods.","code":"data2 <- dt$copy(data)  data2[, mom := TTR::ROC(close, n = 2L)] data2[, mom := mom / max(abs(mom), na.rm = TRUE)]  head(data2) #>      symbol            datetime    open    high     low   close   volume #>      <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #> 1: BTC/USDT 2024-06-30 11:00:00 61540.9 61665.8 61518.7 61553.3 43.87309 #> 2: BTC/USDT 2024-06-30 12:00:00 61553.3 61654.9 61333.0 61490.7 63.42409 #> 3: BTC/USDT 2024-06-30 13:00:00 61490.8 61740.9 61451.1 61711.7 52.80176 #> 4: BTC/USDT 2024-06-30 14:00:00 61711.7 61846.7 61526.1 61581.7 89.92135 #> 5: BTC/USDT 2024-06-30 15:00:00 61581.7 61775.6 61580.9 61717.4 34.02352 #> 6: BTC/USDT 2024-06-30 16:00:00 61719.7 61749.6 61578.4 61601.8 27.14692 #> 2 variable(s) not shown: [turnover <num>, mom <num>] mom <- data2 |>     ggplot2$ggplot(ggplot2$aes(         x = datetime,         y = mom,         group = symbol     )) +     ## ------------------------------------     # momentum     ggplot2$geom_line(         colour = \"yellow\",         linewidth = 1.25,         alpha = 0.5,         na.rm = TRUE     ) +     ## ------------------------------------     # zero line     ggplot2$geom_hline(         yintercept = 0, colour = \"grey\", size = 1, linetype = \"dashed\"     ) +     ggplot2$scale_x_datetime(         date_breaks = \"1 day\", date_minor_breaks = \"1 hour\", date_labels = \"%d %b\"     ) +     ggplot2$labs(         x = ggplot2::element_blank(),         y = \"Momentum\"     ) +     dmplot$theme_dereck_dark() +     ggplot2$theme(         axis.text.x = ggplot2$element_text(angle = 90),         panel.grid.minor = ggplot2$element_blank()     )  print(mom)"},{"path":"https://dereckmezquita.github.io/dmplot/articles/intro-to-financial-indicators-with-dmplot.html","id":"stochastic-oscillator","dir":"Articles","previous_headings":"Calculating and Visualising Financial Indicators","what":"5. Stochastic Oscillator","title":"Introduction to financial indicators with dmplot","text":"Stochastic Oscillator momentum indicator shows location close relative high-low range set number periods. Mathematics: %K = (Current Close - Lowest Low)/(Highest High - Lowest Low) * 100 %D = 3-day SMA %K Stochastic Oscillator used identify overbought oversold conditions. %K line crosses %D line, considered buy signal. %K line crosses %D line, considered sell signal. Dotted yellow lines represent overbought (80) oversold (20) levels. Purple line represents Fast %K line; represents current close relative high-low range last 14 periods. Yellow line represents Slow %D line; 3-day SMA Fast %K line. Fast %K line crosses Slow %D line, considered buy signal. Fast %K line crosses Slow %D line, considered sell signal.","code":"stoch <- function(high, low, close, n = 14, k = 3, d = 3) {     as.list(as.data.frame(TTR::stoch(HLC = data.frame(high, low, close), nFastK = n, nFastD = k, nSlowD = d))) }  data2 <- dt$copy(data)  data2[,     c(\"fastK\", \"fastD\", \"slowD\") := stoch(high, low, close, n = 14, k = 3, d = 3) ]  # similarly to the momentum indicator, we normalise the values between 0 and 100 data2[, fastK := fastK / max(abs(fastK), na.rm = TRUE) * 100] data2[, fastD := fastD / max(abs(fastD), na.rm = TRUE) * 100] data2[, slowD := slowD / max(abs(slowD), na.rm = TRUE) * 100]  head(data2) #>      symbol            datetime    open    high     low   close   volume #>      <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #> 1: BTC/USDT 2024-06-30 11:00:00 61540.9 61665.8 61518.7 61553.3 43.87309 #> 2: BTC/USDT 2024-06-30 12:00:00 61553.3 61654.9 61333.0 61490.7 63.42409 #> 3: BTC/USDT 2024-06-30 13:00:00 61490.8 61740.9 61451.1 61711.7 52.80176 #> 4: BTC/USDT 2024-06-30 14:00:00 61711.7 61846.7 61526.1 61581.7 89.92135 #> 5: BTC/USDT 2024-06-30 15:00:00 61581.7 61775.6 61580.9 61717.4 34.02352 #> 6: BTC/USDT 2024-06-30 16:00:00 61719.7 61749.6 61578.4 61601.8 27.14692 #> 4 variable(s) not shown: [turnover <num>, fastK <num>, fastD <num>, slowD <num>] stoch_plot <- na.omit(data2) |>     ggplot2$ggplot(ggplot2$aes(x = datetime)) +     ggplot2$geom_line(ggplot2$aes(y = fastK, colour = \"Fast %K\")) +     ggplot2$geom_line(ggplot2$aes(y = slowD, colour = \"Slow %D\")) +     ggplot2$geom_hline(         yintercept = c(20, 80),         linetype = \"dashed\",         colour = \"yellow\"     ) +     ggplot2$scale_x_datetime(date_breaks = \"1 day\", date_labels = \"%b %d\") +     ggplot2$scale_y_continuous(limits = c(0, 100)) +     ggplot2$scale_color_manual(values = c(\"Fast %K\" = \"magenta\", \"Slow %D\" = \"yellow\")) +     ggplot2$labs(         title = paste(ticker, \"- Stochastic Oscillator\"),         x = \"Date\",         y = \"Value\"     ) +     dmplot$theme_dereck_dark() +     ggplot2$theme(axis.text.x = ggplot2$element_text(angle = 45, hjust = 1))  print(stoch_plot)"},{"path":"https://dereckmezquita.github.io/dmplot/articles/intro-to-financial-indicators-with-dmplot.html","id":"pulling-it-all-together","dir":"Articles","previous_headings":"","what":"Pulling it all together","title":"Introduction to financial indicators with dmplot","text":"Now built individual layers, can combine single plot visualise indicators together. use gridExtra package arrange plots grid layout.","code":"box::use(gridExtra)"},{"path":"https://dereckmezquita.github.io/dmplot/articles/intro-to-financial-indicators-with-dmplot.html","id":"candlestick-chart-rsi-volume","dir":"Articles","previous_headings":"Pulling it all together","what":"Candlestick Chart + RSI + Volume","title":"Introduction to financial indicators with dmplot","text":"Now fun combine candlestick chart, RSI, volume plots single layout.  Challenge: can adjust left padding plots y-axis labels align?","code":"candle_plot_minus_x_axis <- candle_plot +     ema_layer +     bb_layer +     ggplot2$theme(         axis.text.x = ggplot2$element_blank(),         axis.title.x = ggplot2$element_blank()     ) +     ggplot2$labs(         title = paste(ticker, \"- Candlestick, EMA, Bollinger Bands, RSI, MACD, Volume\"),         y = \"Price (USD)\"     )  rsi_plot_minus_x_axis <- rsi_plot +     ggplot2$theme(         axis.text.x = ggplot2$element_blank(),         axis.title.x = ggplot2$element_blank()     ) +     ggplot2$labs(title = NULL, y = \"RSI\")  macd_plot_minus_x_axis <- macd_plot +     ggplot2$theme(         axis.text.x = ggplot2$element_blank(),         axis.title.x = ggplot2$element_blank()     ) +     ggplot2$labs(title = NULL, y = \"MACD\")  gridExtra$grid.arrange(     candle_plot_minus_x_axis,     rsi_plot_minus_x_axis,     macd_plot_minus_x_axis,     volume_plot,     ncol = 1,     heights = c(3, 1, 1, 1) )"},{"path":"https://dereckmezquita.github.io/dmplot/articles/intro-to-financial-indicators-with-dmplot.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"Introduction to financial indicators with dmplot","text":"vignette demonstrated calculate visualise various financial indicators using dmplot package. ’ve covered mathematics behind indicator provided R functions calculate . combining indicators visualisation capabilities dmplot, can create comprehensive insightful financial charts. Remember indicators can powerful tools technical analysis, used conjunction forms analysis relied upon exclusively making investment decisions. advanced usage customisation options, refer individual function documentation dmplot package explore combining multiple indicators create complex trading strategies.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Dereck Mezquita. Author, maintainer.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Mezquita D (2024). dmplot: framework toolkit financial time series data. R package version 1.3.0, https://github.com/dereckmezquita/dmplot.","code":"@Manual{,   title = {dmplot: A framework and toolkit for financial and time series data},   author = {Dereck Mezquita},   year = {2024},   note = {R package version 1.3.0},   url = {https://github.com/dereckmezquita/dmplot}, }"},{"path":"https://dereckmezquita.github.io/dmplot/index.html","id":"dmplot","dir":"","previous_headings":"","what":"dmplot","title":"A framework and toolkit for financial and time series data","text":"Dereck’s library plotting financial time series data well helper functions plotting style Dereck.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"A framework and toolkit for financial and time series data","text":"can install development version dmplot using:","code":"# install.packages(\"remotes\") remotes::install_github(\"dereckmezquita/dmplot\")"},{"path":"https://dereckmezquita.github.io/dmplot/index.html","id":"financial-data","dir":"","previous_headings":"","what":"Financial data","title":"A framework and toolkit for financial and time series data","text":"must provide function calculates indicators returns list can plotted.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/index.html","id":"get-financial-data","dir":"","previous_headings":"Financial data","what":"Get financial data","title":"A framework and toolkit for financial and time series data","text":"Shown kucoin package interacting KuCoin api. can use source financial data long pass variables stat correctly. Note demonstration dataset included demo/data/ directory.","code":"ticker <- \"BTC/USDT\"  dt <- kucoin::get_market_data(     symbols = ticker,     from = \"2022-11-28 15:29:43 EST\", # lubridate::now() - lubridate::days(7),     to = \"2022-12-05 15:29:31 EST\",# lubridate::now(),     frequency = \"1 hour\" )  dt #>        symbol            datetime    open    high     low   close   volume #>        <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #>   1: BTC/USDT 2022-11-28 15:00:00 16215.3 16233.6 16126.0 16144.1 327.8979 #>   2: BTC/USDT 2022-11-28 16:00:00 16144.1 16382.6 16000.0 16305.9 837.5801 #>   3: BTC/USDT 2022-11-28 17:00:00 16305.9 16382.0 16195.4 16205.4 507.8351 #>  ---                                                                       #> 167: BTC/USDT 2022-12-05 13:00:00 17254.5 17282.5 17208.1 17229.7 105.2655 #> 168: BTC/USDT 2022-12-05 14:00:00 17229.8 17241.4 17175.1 17205.2 140.4375 #> 169: BTC/USDT 2022-12-05 15:00:00 17205.1 17205.1 17021.6 17083.0 504.9158 #> 1 variable(s) not shown: [turnover <num>]"},{"path":"https://dereckmezquita.github.io/dmplot/index.html","id":"plot-financial-data","dir":"","previous_headings":"Financial data","what":"Plot financial data","title":"A framework and toolkit for financial and time series data","text":"demonstrate use stats plotting financial data along theme functions included package: dmplot::stat_candlesticks() dmplot::stat_bollingerbands() dmplot::stat_movingaverages() dmplot::stat_macd() theme functions styling: dmplot::theme_dereck_dark() dmplot::theme_dereck_light()  Plotting MACD (moving average convergence divergence) indicator:  Now let’s plot light theme:","code":"## ------ # redifine our function to return a list ema <- function(x, n, wilder = TRUE) {     return(as.list(as.data.frame(TTR::EMA(x, n = n, wilder = wilder)))) }  bb <- function(close, n = 2, sd = 2) {     return(as.list(as.data.frame(TTR::BBands(close, n = n, sd = sd)))) }  # calculate the short and long moving averages dt[, ema_short := ema(close, n = 10, wilder = TRUE)] dt[, ema_long := ema(close, n = 50, wilder = TRUE)]  # calculate the bollinger bands dt[, c(\"bb_lower\", \"bb_mavg\", \"bb_upper\", \"bb_pct\") := bb(close, n = 10, sd = 2)]  ## ------ # plot p <- dt |>     ggplot2::ggplot(ggplot2::aes(         x = datetime,         open = open,         close = close,         high = high,         low = low,         group = symbol     )) +     ## ------------------------------------     dmplot::stat_candlestick() +     ## ------------------------------------     # moving averages     dmplot::stat_movingaverages(ggplot2::aes(         short = ema_short,         long = ema_long     ), alpha = list(mavg = 0.5)) +     dmplot::stat_bollingerbands(ggplot2::aes(         ymin = bb_lower,         mavg = bb_mavg,         ymax = bb_upper     ), colour = list(\"pink\", \"cyan\", \"cyan\")) +     ## ------------------------------------     ggplot2::scale_x_continuous(n.breaks = 25, labels = \\(x) {         lubridate::floor_date(lubridate::as_datetime(x), \"hours\")     }) +     ggplot2::scale_y_continuous(n.breaks = 25) +     ggplot2::labs(         title = ticker,         x = \"Date\",         y = \"Price (USD)\"     ) +     dmplot::theme_dereck_dark() +     ggplot2::theme(         axis.text.x = ggplot2::element_text(angle = 75, vjust = 0.925, hjust = 0.975),         panel.grid.minor = ggplot2::element_blank()     )  p macd <- function(x, s = 12, l = 26, k = 9) {     return(as.list(as.data.frame(TTR::MACD(x, s, l, k)))) }  # calculate the macd dt[, c(\"macd\", \"macd_signal\") := macd(close, s = 12, l = 26, k = 9)] dt[, macd_diff := macd - macd_signal]  na.omit(dt) |>     ggplot2::ggplot(ggplot2::aes(x = datetime)) +     ## ------------------------------------     dmplot::stat_macd(ggplot2::aes(macd = macd, macd_signal = macd_signal, macd_diff = macd_diff)) +     ## ------------------------------------     ggplot2::scale_x_continuous(n.breaks = 25, labels = \\(x) {         lubridate::floor_date(lubridate::as_datetime(x), \"hours\")     }) +     ggplot2::scale_y_continuous(n.breaks = 25) +     ggplot2::labs(         title = ticker,         x = \"Date\",         y = \"Price (USD)\"     ) +     dmplot::theme_dereck_dark() +     ggplot2::theme(         axis.text.x = ggplot2::element_text(angle = 75, vjust = 0.925, hjust = 0.975),         panel.grid.minor = ggplot2::element_blank()     ) p + dmplot::theme_dereck_light() +     ggplot2::theme(         axis.text.x = ggplot2::element_text(angle = 75, vjust = 0.925, hjust = 0.975),         panel.grid.minor = ggplot2::element_blank()     )"},{"path":"https://dereckmezquita.github.io/dmplot/reference/ggplot2-ggproto.html","id":null,"dir":"Reference","previous_headings":"","what":"StatShadedDateRange — StatShadedDateRange","title":"StatShadedDateRange — StatShadedDateRange","text":"StatShadedDateRange","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_bollingerbands.html","id":null,"dir":"Reference","previous_headings":"","what":"Bollinger bands `ggplot2` layer — stat_bollingerbands","title":"Bollinger bands `ggplot2` layer — stat_bollingerbands","text":"`stat_bollingerbands` `ggplot2` layer allows plot Bollinger bands `ggplot2` plot either providing function calculate bands providing column names required metrics `ggplot2::aes` argument previously calculated. free use whatever algorithm/function wish long : 1. using function must return named `list` - ordered - following elements: `\"bb_lower\"`, `\"bb_mavg\"`, `\"bb_upper\"`, `\"bb_pct\"`. 2. using previously calculated metrics must provide `ggplot2::aes` values; `aes` must `ymin`, `mavg`, `ymax`. See examples details.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_bollingerbands.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bollinger bands `ggplot2` layer — stat_bollingerbands","text":"","code":"stat_bollingerbands(   mapping = NULL,   data = NULL,   geom = \"ribbon\",   position = \"identity\",   na.rm = TRUE,   show.legend = NA,   inherit.aes = TRUE,   alpha = list(ribbon = 0.1, mavg = 0.5),   linetype = list(border = \"dotted\", mavg = 4),   colour = list(ribbon = \"yellow\", border = \"magenta\", mavg = \"magenta\"),   ... )"},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_bollingerbands.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bollinger bands `ggplot2` layer — stat_bollingerbands","text":"mapping `ggplot2::aes` object (required - default `NULL`). data `data.table` object (required - default `NULL`). alpha `list` two elements \"ribbon\" \"mavg\". alpha values ribbon moving average lines (optional - default `list(ribbon = 0.1, mavg = 0.5)`). linetype `list` two elements \"border\" \"mavg\". line types border moving average lines (optional - default `list(border = \"dotted\", mavg = 4)`). ... Additional arguments passed `ggplot2::layer`. linewidth `list` two elements \"border\" \"mavg\". line widths border moving average lines (optional - default `list(border = 1, mavg = 1)`). colours `list` two elements \"ribbon\", \"border\", \"mavg\". colours ribbon, border, moving average lines (optional - default `list(ribbon = \"yellow\", border = \"magenta\", mavg = \"magenta\")`).","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_bollingerbands.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bollinger bands `ggplot2` layer — stat_bollingerbands","text":"`ggplot2` layer.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_bollingerbands.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bollinger bands `ggplot2` layer — stat_bollingerbands","text":"`ggplot2` extension; used `+` operator adding layer `ggplot2` object.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_bollingerbands.html","id":"aesthetics","dir":"Reference","previous_headings":"","what":"Aesthetics","title":"Bollinger bands `ggplot2` layer — stat_bollingerbands","text":"stat_movingaverages understands following aesthetics (required aesthetics bold): x – datetime (x-axis) ymin – required lower bounds band (y-axis) ymax – required upper bounds band (y-axis) mavg – required center line band (y-axis)","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_bollingerbands.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Bollinger bands `ggplot2` layer — stat_bollingerbands","text":"Dereck Mezquita","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_bollingerbands.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bollinger bands `ggplot2` layer — stat_bollingerbands","text":"","code":"# \\donttest{  # get some financial data # kucoin is private package - you can use any data source ticker <- \"BTC/USDT\"  dt <- kucoin::get_market_data(     symbols = ticker,     from = \"2022-11-28 15:29:43 EST\", # lubridate::now() - lubridate::days(7),     to = \"2022-12-05 15:29:31 EST\",# lubridate::now(),     frequency = \"1 hour\" )  dt #>        symbol            datetime    open    high     low   close   volume #>        <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #>   1: BTC/USDT 2022-11-28 15:00:00 16215.3 16233.6 16126.0 16144.1 327.8979 #>   2: BTC/USDT 2022-11-28 16:00:00 16144.1 16382.6 16000.0 16305.9 837.5801 #>   3: BTC/USDT 2022-11-28 17:00:00 16305.9 16382.0 16195.4 16205.4 507.8351 #>   4: BTC/USDT 2022-11-28 18:00:00 16206.1 16230.7 16146.5 16162.6 252.3387 #>   5: BTC/USDT 2022-11-28 19:00:00 16161.7 16253.3 16150.1 16220.9 225.4121 #>  ---                                                                       #> 165: BTC/USDT 2022-12-05 11:00:00 17295.2 17314.3 17283.8 17312.0 176.8633 #> 166: BTC/USDT 2022-12-05 12:00:00 17312.0 17318.6 17230.5 17254.5 199.6922 #> 167: BTC/USDT 2022-12-05 13:00:00 17254.5 17282.5 17208.1 17229.7 105.2655 #> 168: BTC/USDT 2022-12-05 14:00:00 17229.8 17241.4 17175.1 17205.2 140.4375 #> 169: BTC/USDT 2022-12-05 15:00:00 17205.1 17205.1 17021.6 17083.0 504.9158 #>      turnover #>         <num> #>   1:  5301836 #>   2: 13557348 #>   3:  8270203 #>   4:  4082464 #>   5:  3653147 #>  ---          #> 165:  3058929 #> 166:  3447960 #> 167:  1815447 #> 168:  2416907 #> 169:  8630174  # we need a function that calculates the indicator for us # typically I like to write my own functions in C++; in this case we will use TTR's # the stat expects a named list to be returned - we redefine ttr bb <- function(close, n = 10, sd = 2) {     return(as.list(as.data.frame(TTR::BBands(close, n = n, sd = sd)))) }  # calculate the short and long moving averages dt[, c(\"bb_lower\", \"bb_mavg\", \"bb_upper\", \"bb_pct\") := bb(close, n = 10, sd = 2)] #>        symbol            datetime    open    high     low   close   volume #>        <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #>   1: BTC/USDT 2022-11-28 15:00:00 16215.3 16233.6 16126.0 16144.1 327.8979 #>   2: BTC/USDT 2022-11-28 16:00:00 16144.1 16382.6 16000.0 16305.9 837.5801 #>   3: BTC/USDT 2022-11-28 17:00:00 16305.9 16382.0 16195.4 16205.4 507.8351 #>   4: BTC/USDT 2022-11-28 18:00:00 16206.1 16230.7 16146.5 16162.6 252.3387 #>   5: BTC/USDT 2022-11-28 19:00:00 16161.7 16253.3 16150.1 16220.9 225.4121 #>  ---                                                                       #> 165: BTC/USDT 2022-12-05 11:00:00 17295.2 17314.3 17283.8 17312.0 176.8633 #> 166: BTC/USDT 2022-12-05 12:00:00 17312.0 17318.6 17230.5 17254.5 199.6922 #> 167: BTC/USDT 2022-12-05 13:00:00 17254.5 17282.5 17208.1 17229.7 105.2655 #> 168: BTC/USDT 2022-12-05 14:00:00 17229.8 17241.4 17175.1 17205.2 140.4375 #> 169: BTC/USDT 2022-12-05 15:00:00 17205.1 17205.1 17021.6 17083.0 504.9158 #>      turnover bb_lower  bb_mavg bb_upper        bb_pct #>         <num>    <num>    <num>    <num>         <num> #>   1:  5301836       NA       NA       NA            NA #>   2: 13557348       NA       NA       NA            NA #>   3:  8270203       NA       NA       NA            NA #>   4:  4082464       NA       NA       NA            NA #>   5:  3653147       NA       NA       NA            NA #>  ---                                                   #> 165:  3058929 17207.96 17301.26 17394.56  0.5575587312 #> 166:  3447960 17212.50 17302.61 17392.72  0.2330342843 #> 167:  1815447 17229.77 17305.83 17381.89 -0.0004838333 #> 168:  2416907 17201.48 17290.90 17380.32  0.0208028612 #> 169:  8630174 17117.69 17265.48 17413.27 -0.1173496659  dt |>     ggplot2::ggplot(ggplot2::aes(         x = datetime,         open = open,         close = close,         high = high,         low = low,         group = symbol     )) +     ## ------------------------------------     dmplot::stat_candlestick() +     ## ------------------------------------     # provide the colnames to the calculated indicators as aes values     dmplot::stat_bollingerbands(ggplot2::aes(ymin = bb_lower, mavg = bb_mavg, ymax = bb_upper), colour = list(\"pink\", \"cyan\", \"cyan\")) +     ## ------------------------------------     ggplot2::scale_x_continuous(n.breaks = 25, labels = \\(x) {         lubridate::floor_date(lubridate::as_datetime(x), \"hours\")     }) +     ggplot2::scale_y_continuous(n.breaks = 25) +     ggplot2::labs(         title = ticker,         x = \"Date\",         y = \"Price (USD)\"     ) +     dmplot::theme_dereck_dark() +     ggplot2::theme(         axis.text.x = ggplot2::element_text(angle = 75, vjust = 0.925, hjust = 0.975),         panel.grid.minor = ggplot2::element_blank()     )  # }"},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_candlestick.html","id":null,"dir":"Reference","previous_headings":"","what":"Candlesticks financial `ggplot2` layer — stat_candlestick","title":"Candlesticks financial `ggplot2` layer — stat_candlestick","text":"Candlesticks financial `ggplot2` layer","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_candlestick.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Candlesticks financial `ggplot2` layer — stat_candlestick","text":"","code":"stat_candlestick(   mapping = NULL,   data = NULL,   geom = \"linerange\",   position = \"identity\",   na.rm = FALSE,   show.legend = NA,   inherit.aes = TRUE,   colours = list(up = \"#55BE8B\", down = \"#ED4D5D\", no_change = \"#535453\"),   ... )"},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_candlestick.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Candlesticks financial `ggplot2` layer — stat_candlestick","text":"mapping `ggplot2::aes` object (required - default `NULL`). `x`: x-axis value, usually representing time. `open`: opening price. `close`: closing price. `high`: highest price time range. `low`: lowest price time range. `group`: (optional) grouping variable. data `data.table` object (required - default `NULL`). colours `list` three elements \"\", \"\", \"no_change\". colours candlesticks positive change price action, negative change change respectively. ... Additional arguments passed `ggplot2::layer`.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_candlestick.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Candlesticks financial `ggplot2` layer — stat_candlestick","text":"`ggplot2::layer` object.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_candlestick.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Candlesticks financial `ggplot2` layer — stat_candlestick","text":"`ggplot2` extension; used `+` operator adding layer `ggplot2` object.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_candlestick.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Candlesticks financial `ggplot2` layer — stat_candlestick","text":"Dereck Mezquita","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_candlestick.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Candlesticks financial `ggplot2` layer — stat_candlestick","text":"","code":"# get some financial data # kucoin is a private package - you can use any data source ticker <- \"BTC/USDT\"  dt <- kucoin::get_market_data(     symbols = ticker,     from = \"2022-11-28 15:29:43 EST\", # lubridate::now() - lubridate::days(7),     to = \"2022-12-05 15:29:31 EST\",# lubridate::now(),     frequency = \"1 hour\" )  dt #>        symbol            datetime    open    high     low   close   volume #>        <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #>   1: BTC/USDT 2022-11-28 15:00:00 16215.3 16233.6 16126.0 16144.1 327.8979 #>   2: BTC/USDT 2022-11-28 16:00:00 16144.1 16382.6 16000.0 16305.9 837.5801 #>   3: BTC/USDT 2022-11-28 17:00:00 16305.9 16382.0 16195.4 16205.4 507.8351 #>   4: BTC/USDT 2022-11-28 18:00:00 16206.1 16230.7 16146.5 16162.6 252.3387 #>   5: BTC/USDT 2022-11-28 19:00:00 16161.7 16253.3 16150.1 16220.9 225.4121 #>  ---                                                                       #> 165: BTC/USDT 2022-12-05 11:00:00 17295.2 17314.3 17283.8 17312.0 176.8633 #> 166: BTC/USDT 2022-12-05 12:00:00 17312.0 17318.6 17230.5 17254.5 199.6922 #> 167: BTC/USDT 2022-12-05 13:00:00 17254.5 17282.5 17208.1 17229.7 105.2655 #> 168: BTC/USDT 2022-12-05 14:00:00 17229.8 17241.4 17175.1 17205.2 140.4375 #> 169: BTC/USDT 2022-12-05 15:00:00 17205.1 17205.1 17021.6 17083.0 504.9158 #>      turnover #>         <num> #>   1:  5301836 #>   2: 13557348 #>   3:  8270203 #>   4:  4082464 #>   5:  3653147 #>  ---          #> 165:  3058929 #> 166:  3447960 #> 167:  1815447 #> 168:  2416907 #> 169:  8630174  dt |>     ggplot2::ggplot(ggplot2::aes(         x = datetime,         open = open,         close = close,         high = high,         low = low,         group = symbol     )) +     ## ------------------------------------     dmplot::stat_candlestick() +     ## ------------------------------------     ggplot2::scale_x_continuous(n.breaks = 25, labels = \\(x) {         lubridate::floor_date(lubridate::as_datetime(x), \"hours\")     }) +     ggplot2::scale_y_continuous(n.breaks = 25) +     ggplot2::labs(         title = ticker,         x = \"Date\",         y = \"Price (USD)\"     ) +     dmplot::theme_dereck_dark() +     ggplot2::theme(         axis.text.x = ggplot2::element_text(angle = 75, vjust = 0.925, hjust = 0.975),         panel.grid.minor = ggplot2::element_blank()     )"},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_macd.html","id":null,"dir":"Reference","previous_headings":"","what":"Moving average convergence divergence (macd) `ggplot2` layer — stat_macd","title":"Moving average convergence divergence (macd) `ggplot2` layer — stat_macd","text":"`stat_macd` `ggplot2` layer allows plot `ggplot2` layer moving average convergence divergence (macd) providing column names `ggplot2::aes` previously calculated metrics. free use whatever algorithm desire; result line plot overlayed histogram. use layer provide `ggplot2::aes` values `x` (datetime x-axis) `macd` (y-axis) `macd_signal` (y-axis) `macd_diff` (y-axis). See examples details.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_macd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Moving average convergence divergence (macd) `ggplot2` layer — stat_macd","text":"","code":"stat_macd(   mapping = NULL,   data = NULL,   geom = \"line\",   position = \"identity\",   na.rm = TRUE,   show.legend = NA,   inherit.aes = TRUE,   alpha_lines = 0.75,   alpha_histogram = 0.5,   colour_lines = list(macd = \"blue\", macd_signal = \"red\"),   colour_histogram = list(positive = NA_character_, negative = NA_character_),   fill_histogram = list(positive = \"green\", negative = \"red\"),   ... )"},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_macd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Moving average convergence divergence (macd) `ggplot2` layer — stat_macd","text":"mapping `ggplot2::aes` object (required - default `NULL`). data `data.table` object (required - default `NULL`). alpha_lines `numeric` vector length one; alpha lines (optional - default `0.75`). alpha_histogram `numeric` vector length one; alpha histogram (optional - default `0.5`). colour_lines named unnamed `list` two elements \"macd\" \"macd_signal\" (optional - default `list(macd = \"blue\", macd_signal = \"red\")`). colour_histogram named unnamed `list` two elements \"positive\" \"negative\" (optional - default `list(positive = NA_character_, negative = NA_character_)`). fill_histogram named unnamed `list` two elements \"positive\" \"negative\" (optional - default `list(positive = \"green\", negative = \"red\")`). linewidth `numeric` vector length one; linewidth line (optional - default `1.75`).","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_macd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Moving average convergence divergence (macd) `ggplot2` layer — stat_macd","text":"`ggplot2::layer` object.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_macd.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Moving average convergence divergence (macd) `ggplot2` layer — stat_macd","text":"`ggplot2` extension; used `+` operator adding layer `ggplot2` object.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_macd.html","id":"aesthetics","dir":"Reference","previous_headings":"","what":"Aesthetics","title":"Moving average convergence divergence (macd) `ggplot2` layer — stat_macd","text":"stat_movingaverages understands following aesthetics (required aesthetics bold): x – datetime (x-axis) macd – y-axis macd_signal – y-axis macd_diff – y-axis","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_macd.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Moving average convergence divergence (macd) `ggplot2` layer — stat_macd","text":"Dereck Mezquita","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_macd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Moving average convergence divergence (macd) `ggplot2` layer — stat_macd","text":"","code":"# get some financial data # kucoin is private package - you can use any data source ticker <- \"BTC/USDT\"  dt <- kucoin::get_market_data(     symbols = ticker,     from = \"2022-11-28 15:29:43 EST\", # lubridate::now() - lubridate::days(7),     to = \"2022-12-05 15:29:31 EST\",# lubridate::now(),     frequency = \"1 hour\" )  dt #>        symbol            datetime    open    high     low   close   volume #>        <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #>   1: BTC/USDT 2022-11-28 15:00:00 16215.3 16233.6 16126.0 16144.1 327.8979 #>   2: BTC/USDT 2022-11-28 16:00:00 16144.1 16382.6 16000.0 16305.9 837.5801 #>   3: BTC/USDT 2022-11-28 17:00:00 16305.9 16382.0 16195.4 16205.4 507.8351 #>   4: BTC/USDT 2022-11-28 18:00:00 16206.1 16230.7 16146.5 16162.6 252.3387 #>   5: BTC/USDT 2022-11-28 19:00:00 16161.7 16253.3 16150.1 16220.9 225.4121 #>  ---                                                                       #> 165: BTC/USDT 2022-12-05 11:00:00 17295.2 17314.3 17283.8 17312.0 176.8633 #> 166: BTC/USDT 2022-12-05 12:00:00 17312.0 17318.6 17230.5 17254.5 199.6922 #> 167: BTC/USDT 2022-12-05 13:00:00 17254.5 17282.5 17208.1 17229.7 105.2655 #> 168: BTC/USDT 2022-12-05 14:00:00 17229.8 17241.4 17175.1 17205.2 140.4375 #> 169: BTC/USDT 2022-12-05 15:00:00 17205.1 17205.1 17021.6 17083.0 504.9158 #>      turnover #>         <num> #>   1:  5301836 #>   2: 13557348 #>   3:  8270203 #>   4:  4082464 #>   5:  3653147 #>  ---          #> 165:  3058929 #> 166:  3447960 #> 167:  1815447 #> 168:  2416907 #> 169:  8630174  # we need a function that calculates the indicator for us # typically I like to write my own functions in C++; in this case we will use TTR's # the stat expects a named list to be returned - we redefine ttr macd <- function(x, s = 12, l = 26, k = 9) {as.list(as.data.frame(TTR::MACD(x, s, l, k)))}  # macd(dt$close) dt[, c(\"macd\", \"macd_signal\") := macd(close, s = 12, l = 26, k = 9)] #>        symbol            datetime    open    high     low   close   volume #>        <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #>   1: BTC/USDT 2022-11-28 15:00:00 16215.3 16233.6 16126.0 16144.1 327.8979 #>   2: BTC/USDT 2022-11-28 16:00:00 16144.1 16382.6 16000.0 16305.9 837.5801 #>   3: BTC/USDT 2022-11-28 17:00:00 16305.9 16382.0 16195.4 16205.4 507.8351 #>   4: BTC/USDT 2022-11-28 18:00:00 16206.1 16230.7 16146.5 16162.6 252.3387 #>   5: BTC/USDT 2022-11-28 19:00:00 16161.7 16253.3 16150.1 16220.9 225.4121 #>  ---                                                                       #> 165: BTC/USDT 2022-12-05 11:00:00 17295.2 17314.3 17283.8 17312.0 176.8633 #> 166: BTC/USDT 2022-12-05 12:00:00 17312.0 17318.6 17230.5 17254.5 199.6922 #> 167: BTC/USDT 2022-12-05 13:00:00 17254.5 17282.5 17208.1 17229.7 105.2655 #> 168: BTC/USDT 2022-12-05 14:00:00 17229.8 17241.4 17175.1 17205.2 140.4375 #> 169: BTC/USDT 2022-12-05 15:00:00 17205.1 17205.1 17021.6 17083.0 504.9158 #>      turnover      macd macd_signal #>         <num>     <num>       <num> #>   1:  5301836        NA          NA #>   2: 13557348        NA          NA #>   3:  8270203        NA          NA #>   4:  4082464        NA          NA #>   5:  3653147        NA          NA #>  ---                                #> 165:  3058929 0.4731906   0.4505607 #> 166:  3447960 0.4303121   0.4465110 #> 167:  1815447 0.3803542   0.4332796 #> 168:  2416907 0.3255538   0.4117344 #> 169:  8630174 0.2223466   0.3738569 dt[, macd_diff := macd - macd_signal] #>        symbol            datetime    open    high     low   close   volume #>        <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #>   1: BTC/USDT 2022-11-28 15:00:00 16215.3 16233.6 16126.0 16144.1 327.8979 #>   2: BTC/USDT 2022-11-28 16:00:00 16144.1 16382.6 16000.0 16305.9 837.5801 #>   3: BTC/USDT 2022-11-28 17:00:00 16305.9 16382.0 16195.4 16205.4 507.8351 #>   4: BTC/USDT 2022-11-28 18:00:00 16206.1 16230.7 16146.5 16162.6 252.3387 #>   5: BTC/USDT 2022-11-28 19:00:00 16161.7 16253.3 16150.1 16220.9 225.4121 #>  ---                                                                       #> 165: BTC/USDT 2022-12-05 11:00:00 17295.2 17314.3 17283.8 17312.0 176.8633 #> 166: BTC/USDT 2022-12-05 12:00:00 17312.0 17318.6 17230.5 17254.5 199.6922 #> 167: BTC/USDT 2022-12-05 13:00:00 17254.5 17282.5 17208.1 17229.7 105.2655 #> 168: BTC/USDT 2022-12-05 14:00:00 17229.8 17241.4 17175.1 17205.2 140.4375 #> 169: BTC/USDT 2022-12-05 15:00:00 17205.1 17205.1 17021.6 17083.0 504.9158 #>      turnover      macd macd_signal   macd_diff #>         <num>     <num>       <num>       <num> #>   1:  5301836        NA          NA          NA #>   2: 13557348        NA          NA          NA #>   3:  8270203        NA          NA          NA #>   4:  4082464        NA          NA          NA #>   5:  3653147        NA          NA          NA #>  ---                                            #> 165:  3058929 0.4731906   0.4505607  0.02262998 #> 166:  3447960 0.4303121   0.4465110 -0.01619881 #> 167:  1815447 0.3803542   0.4332796 -0.05292542 #> 168:  2416907 0.3255538   0.4117344 -0.08618062 #> 169:  8630174 0.2223466   0.3738569 -0.15151027  na.omit(dt) |>     ggplot2::ggplot(ggplot2::aes(x = datetime)) +     dmplot::stat_macd(ggplot2::aes(macd = macd, macd_signal = macd_signal, macd_diff = macd_diff)) +     ## ------------------------------------     # provide the colnames to the calculated indicators as aes values     ## ------------------------------------     ggplot2::scale_x_continuous(n.breaks = 25, labels = \\(x) {         lubridate::floor_date(lubridate::as_datetime(x), \"hours\")     }) +     ggplot2::scale_y_continuous(n.breaks = 25) +     ggplot2::labs(         title = ticker,         x = \"Date\",         y = \"Price (USD)\"     ) +     dmplot::theme_dereck_dark() +     ggplot2::theme(         axis.text.x = ggplot2::element_text(angle = 75, vjust = 0.925, hjust = 0.975),         panel.grid.minor = ggplot2::element_blank()     )"},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_movingaverages.html","id":null,"dir":"Reference","previous_headings":"","what":"Moving averages `ggplot2` layer — stat_movingaverages","title":"Moving averages `ggplot2` layer — stat_movingaverages","text":"`stat_movingaverages` `ggplot2` layer allows plot moving averages `ggplot2` plot either providing column names `ggplot2::aes` previously calculated metrics. free use whatever algorithm desire; result two line plots one short moving average one long moving average. use layer provide `ggplot2::aes` values `x` (datetime x-axis) `short` `long` (y-axis). See examples details.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_movingaverages.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Moving averages `ggplot2` layer — stat_movingaverages","text":"","code":"stat_movingaverages(   mapping = NULL,   data = NULL,   geom = \"line\",   position = \"identity\",   na.rm = TRUE,   show.legend = NA,   inherit.aes = TRUE,   linewidth = 1.75,   alpha = 0.75,   colour = list(short = \"yellow\", long = \"purple\"),   ... )"},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_movingaverages.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Moving averages `ggplot2` layer — stat_movingaverages","text":"mapping `ggplot2::aes` object (required - default `NULL`). data `data.table` object (required - default `NULL`). linewidth `numeric` vector length one; width line (optional - default `1.75`). alpha `numeric` vector length one; alpha line (optional - default `0.75`). colour named unnamed `list` three elements \"short\" \"long\". colours short long moving averages (optional - default `list(short = \"red\", long = \"blue\")`).","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_movingaverages.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Moving averages `ggplot2` layer — stat_movingaverages","text":"`ggplot2::layer` object.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_movingaverages.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Moving averages `ggplot2` layer — stat_movingaverages","text":"`ggplot2` extension; used `+` operator adding layer `ggplot2` object.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_movingaverages.html","id":"aesthetics","dir":"Reference","previous_headings":"","what":"Aesthetics","title":"Moving averages `ggplot2` layer — stat_movingaverages","text":"stat_movingaverages understands following aesthetics (required aesthetics bold): x – datetime (x-axis) short – values short moving average (y-axis). long – values long moving average (y-axis)","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_movingaverages.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Moving averages `ggplot2` layer — stat_movingaverages","text":"Dereck Mezquita","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_movingaverages.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Moving averages `ggplot2` layer — stat_movingaverages","text":"","code":"# get some financial data # kucoin is private package - you can use any data source ticker <- \"BTC/USDT\"  dt <- kucoin::get_market_data(     symbols = ticker,     from = \"2022-11-28 15:29:43 EST\", # lubridate::now() - lubridate::days(7),     to = \"2022-12-05 15:29:31 EST\", # lubridate::now(),     frequency = \"1 hour\" )  dt #>        symbol            datetime    open    high     low   close   volume #>        <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #>   1: BTC/USDT 2022-11-28 15:00:00 16215.3 16233.6 16126.0 16144.1 327.8979 #>   2: BTC/USDT 2022-11-28 16:00:00 16144.1 16382.6 16000.0 16305.9 837.5801 #>   3: BTC/USDT 2022-11-28 17:00:00 16305.9 16382.0 16195.4 16205.4 507.8351 #>   4: BTC/USDT 2022-11-28 18:00:00 16206.1 16230.7 16146.5 16162.6 252.3387 #>   5: BTC/USDT 2022-11-28 19:00:00 16161.7 16253.3 16150.1 16220.9 225.4121 #>  ---                                                                       #> 165: BTC/USDT 2022-12-05 11:00:00 17295.2 17314.3 17283.8 17312.0 176.8633 #> 166: BTC/USDT 2022-12-05 12:00:00 17312.0 17318.6 17230.5 17254.5 199.6922 #> 167: BTC/USDT 2022-12-05 13:00:00 17254.5 17282.5 17208.1 17229.7 105.2655 #> 168: BTC/USDT 2022-12-05 14:00:00 17229.8 17241.4 17175.1 17205.2 140.4375 #> 169: BTC/USDT 2022-12-05 15:00:00 17205.1 17205.1 17021.6 17083.0 504.9158 #>      turnover #>         <num> #>   1:  5301836 #>   2: 13557348 #>   3:  8270203 #>   4:  4082464 #>   5:  3653147 #>  ---          #> 165:  3058929 #> 166:  3447960 #> 167:  1815447 #> 168:  2416907 #> 169:  8630174  # we need a function that calculates the indicator for us # typically I like to write my own functions in C++; in this case we will use TTR's # the stat expects a named list to be returned - we redefine ttr ema <- function(close, n = 2, wilder = TRUE) {     return(as.list(as.data.frame(TTR::EMA(close, n = n, wilder = wilder)))) }  # calculate the short and long moving averages dt[, ema_short := ema(close, n = 10, wilder = TRUE)] #>        symbol            datetime    open    high     low   close   volume #>        <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #>   1: BTC/USDT 2022-11-28 15:00:00 16215.3 16233.6 16126.0 16144.1 327.8979 #>   2: BTC/USDT 2022-11-28 16:00:00 16144.1 16382.6 16000.0 16305.9 837.5801 #>   3: BTC/USDT 2022-11-28 17:00:00 16305.9 16382.0 16195.4 16205.4 507.8351 #>   4: BTC/USDT 2022-11-28 18:00:00 16206.1 16230.7 16146.5 16162.6 252.3387 #>   5: BTC/USDT 2022-11-28 19:00:00 16161.7 16253.3 16150.1 16220.9 225.4121 #>  ---                                                                       #> 165: BTC/USDT 2022-12-05 11:00:00 17295.2 17314.3 17283.8 17312.0 176.8633 #> 166: BTC/USDT 2022-12-05 12:00:00 17312.0 17318.6 17230.5 17254.5 199.6922 #> 167: BTC/USDT 2022-12-05 13:00:00 17254.5 17282.5 17208.1 17229.7 105.2655 #> 168: BTC/USDT 2022-12-05 14:00:00 17229.8 17241.4 17175.1 17205.2 140.4375 #> 169: BTC/USDT 2022-12-05 15:00:00 17205.1 17205.1 17021.6 17083.0 504.9158 #>      turnover ema_short #>         <num>     <num> #>   1:  5301836        NA #>   2: 13557348        NA #>   3:  8270203        NA #>   4:  4082464        NA #>   5:  3653147        NA #>  ---                    #> 165:  3058929  17226.35 #> 166:  3447960  17229.17 #> 167:  1815447  17229.22 #> 168:  2416907  17226.82 #> 169:  8630174  17212.44 dt[, ema_long := ema(close, n = 50, wilder = TRUE)] #>        symbol            datetime    open    high     low   close   volume #>        <char>              <POSc>   <num>   <num>   <num>   <num>    <num> #>   1: BTC/USDT 2022-11-28 15:00:00 16215.3 16233.6 16126.0 16144.1 327.8979 #>   2: BTC/USDT 2022-11-28 16:00:00 16144.1 16382.6 16000.0 16305.9 837.5801 #>   3: BTC/USDT 2022-11-28 17:00:00 16305.9 16382.0 16195.4 16205.4 507.8351 #>   4: BTC/USDT 2022-11-28 18:00:00 16206.1 16230.7 16146.5 16162.6 252.3387 #>   5: BTC/USDT 2022-11-28 19:00:00 16161.7 16253.3 16150.1 16220.9 225.4121 #>  ---                                                                       #> 165: BTC/USDT 2022-12-05 11:00:00 17295.2 17314.3 17283.8 17312.0 176.8633 #> 166: BTC/USDT 2022-12-05 12:00:00 17312.0 17318.6 17230.5 17254.5 199.6922 #> 167: BTC/USDT 2022-12-05 13:00:00 17254.5 17282.5 17208.1 17229.7 105.2655 #> 168: BTC/USDT 2022-12-05 14:00:00 17229.8 17241.4 17175.1 17205.2 140.4375 #> 169: BTC/USDT 2022-12-05 15:00:00 17205.1 17205.1 17021.6 17083.0 504.9158 #>      turnover ema_short ema_long #>         <num>     <num>    <num> #>   1:  5301836        NA       NA #>   2: 13557348        NA       NA #>   3:  8270203        NA       NA #>   4:  4082464        NA       NA #>   5:  3653147        NA       NA #>  ---                             #> 165:  3058929  17226.35 17017.34 #> 166:  3447960  17229.17 17022.08 #> 167:  1815447  17229.22 17026.23 #> 168:  2416907  17226.82 17029.81 #> 169:  8630174  17212.44 17030.88  dt |>     ggplot2::ggplot(ggplot2::aes(         x = datetime,         open = open,         close = close,         high = high,         low = low,         group = symbol     )) +     ## ------------------------------------     dmplot::stat_candlestick() +     ## ------------------------------------     # provide the colnames to the calculated indicators as aes values     dmplot::stat_movingaverages(ggplot2::aes(short = ema_short, long = ema_long), alpha = list(mavg = 0.5)) +     ## ------------------------------------     ggplot2::scale_x_continuous(n.breaks = 25, labels = \\(x) {         lubridate::floor_date(lubridate::as_datetime(x), \"hours\")     }) +     ggplot2::scale_y_continuous(n.breaks = 25) +     ggplot2::labs(         title = ticker,         x = \"Date\",         y = \"Price (USD)\"     ) +     dmplot::theme_dereck_dark() +     ggplot2::theme(         axis.text.x = ggplot2::element_text(angle = 75, vjust = 0.925, hjust = 0.975),         panel.grid.minor = ggplot2::element_blank()     )"},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_shade_ranges.html","id":null,"dir":"Reference","previous_headings":"","what":"Shaded Date Ranges ggplot2 layer — stat_shade_ranges","title":"Shaded Date Ranges ggplot2 layer — stat_shade_ranges","text":"function creates ggplot2 layer shades date ranges based grouped data. particularly useful highlighting specific periods time series data.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_shade_ranges.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Shaded Date Ranges ggplot2 layer — stat_shade_ranges","text":"","code":"stat_shade_ranges(   mapping = NULL,   data = NULL,   geom = \"linerange\",   position = \"identity\",   na.rm = TRUE,   show.legend = NA,   inherit.aes = TRUE,   ... )"},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_shade_ranges.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Shaded Date Ranges ggplot2 layer — stat_shade_ranges","text":"mapping Set aesthetic mappings created aes. Must include `x` dates `group` categorizing ranges. data data displayed layer. NULL, default, data inherited plot data specified call ggplot. geom geometric object use display data. Default \"linerange\". position Position adjustment, either string, result call position adjustment function. Default \"identity\". na.rm FALSE, default, missing values removed warning. TRUE, missing values silently removed. show.legend logical. layer included legends? NA, default, includes aesthetics mapped. inherit.aes FALSE, overrides default aesthetics, rather combining . ... arguments passed layer. often aesthetics, used set aesthetic fixed value.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_shade_ranges.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Shaded Date Ranges ggplot2 layer — stat_shade_ranges","text":"ggplot2 layer object.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/stat_shade_ranges.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Shaded Date Ranges ggplot2 layer — stat_shade_ranges","text":"","code":"if (FALSE) { # \\dontrun{ library(ggplot2) library(data.table)  # Create sample data dt <- data.table(     datetime = seq(as.POSIXct(\"2023-01-01\"), as.POSIXct(\"2023-12-31\"), by = \"day\"),     close = runif(365, 100, 200),     call = sample(c(\"buy\", \"sell\", \"none\"), 365, replace = TRUE, prob = c(0.3, 0.3, 0.4)) )  # Create plot with shaded ranges ggplot(dt, aes(x = datetime)) +     geom_line(aes(y = close), linewidth = 1.5, colour = \"white\") +     stat_shade_ranges(aes(group = call, fill = call), alpha = 0.25) +     scale_fill_manual(         name = \"Call\",         values = c(\"buy\" = \"green\", \"sell\" = \"red\", \"none\" = \"gray\")     ) +     theme_minimal() +     labs(title = \"Stock Price with Buy/Sell Signals\", x = \"Date\", y = \"Price\") } # }"},{"path":"https://dereckmezquita.github.io/dmplot/reference/theme_dereck_dark.html","id":null,"dir":"Reference","previous_headings":"","what":"Dereck's ggplot theme (dark) — theme_dereck_dark","title":"Dereck's ggplot theme (dark) — theme_dereck_dark","text":"Dereck's ggplot theme (dark)","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/theme_dereck_dark.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dereck's ggplot theme (dark) — theme_dereck_dark","text":"","code":"theme_dereck_dark(base_size = 12, base_family = \"\")"},{"path":"https://dereckmezquita.github.io/dmplot/reference/theme_dereck_dark.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Dereck's ggplot theme (dark) — theme_dereck_dark","text":"Dereck Mezquita function allows add derecksnotes theme ggplot graphics.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/theme_dereck_dark.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Dereck's ggplot theme (dark) — theme_dereck_dark","text":"","code":"iris |>     ggplot2::ggplot(ggplot2::aes(x = Sepal.Length, y = Sepal.Width)) +     ggplot2::geom_point(ggplot2::aes(color = Species, shape = Species)) +     ggplot2::labs(title = \"Iris data\", subtitle = \"Classic data\", x = \"Sepal Length\", y = \"Sepal Width\") +     ggplot2::facet_grid(~Species) +     dmplot::theme_dereck_dark()   data.frame(year = time(nhtemp), tmps = as.matrix(nhtemp)) |>     ggplot2::ggplot(ggplot2::aes(x = year, y = tmps)) +     ggplot2::geom_line() +     # geom_hline(yintercept = 0, size = 1, colour = \"#333333\") +     ggplot2::labs(title = \"New Hampshire yearly temperatures\", subtitle = \"Collected between 1912 and 1971\", x = \"Year\", y = \"Average temperature\") +     dmplot::theme_dereck_dark() #> Don't know how to automatically pick scale for object of type <ts>. Defaulting #> to continuous."},{"path":"https://dereckmezquita.github.io/dmplot/reference/theme_dereck_light.html","id":null,"dir":"Reference","previous_headings":"","what":"Dereck's ggplot theme (light) — theme_dereck_light","title":"Dereck's ggplot theme (light) — theme_dereck_light","text":"Dereck's ggplot theme (light)","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/theme_dereck_light.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dereck's ggplot theme (light) — theme_dereck_light","text":"","code":"theme_dereck_light(base_size = 11, base_family = \"\")"},{"path":"https://dereckmezquita.github.io/dmplot/reference/theme_dereck_light.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Dereck's ggplot theme (light) — theme_dereck_light","text":"Dereck Mezquita function allows add derecksnotes theme ggplot graphics.","code":""},{"path":"https://dereckmezquita.github.io/dmplot/reference/theme_dereck_light.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Dereck's ggplot theme (light) — theme_dereck_light","text":"","code":"iris |>     ggplot2::ggplot(ggplot2::aes(x = Sepal.Length, y = Sepal.Width)) +     ggplot2::geom_point(ggplot2::aes(color = Species, shape = Species)) +     ggplot2::labs(title = \"Iris data\", subtitle = \"Classic data\", x = \"Sepal Length\", y = \"Sepal Width\") +     ggplot2::facet_grid(~Species) +     dmplot::theme_dereck_light()   data.frame(year = time(nhtemp), tmps = as.matrix(nhtemp)) |>     ggplot2::ggplot(ggplot2::aes(x = year, y = tmps)) +     ggplot2::geom_line() +     # geom_hline(yintercept = 0, size = 1, colour = \"#333333\") +     ggplot2::labs(title = \"New Hampshire yearly temperatures\", subtitle = \"Collected between 1912 and 1971\", x = \"Year\", y = \"Average temperature\") +     dmplot::theme_dereck_light() #> Don't know how to automatically pick scale for object of type <ts>. Defaulting #> to continuous."}]
