<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="A plotting toolkit for financial and time series data. The package provides algorithms, functions, layers and outlines a framework for working with and analysing financial and time series data. The package also includes high-performance functions for calculating technical indicators written in C++.">
<title>A Framework and Toolkit for Financial and Time Series Data • dmplot</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="A Framework and Toolkit for Financial and Time Series Data">
<meta property="og:description" content="A plotting toolkit for financial and time series data. The package provides algorithms, functions, layers and outlines a framework for working with and analysing financial and time series data. The package also includes high-performance functions for calculating technical indicators written in C++.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">dmplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/getting-started-with-the-dmplot-framwork.html">Getting Started with the dmplot Framework</a>
    <a class="dropdown-item" href="articles/intro-to-financial-indicators-with-dmplot.html">Intro to Financial Indicators with dmplot</a>
    <a class="dropdown-item" href="articles/cpp-high-performance-technical-indicators.html">C++ high-performance technical indicators</a>
    <a class="dropdown-item" href="articles/intro-to-monte-carlo-simulations.html">Introduction to Monte Carlo Simulations</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="articles/donate.html">Donate</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dereckmezquita/dmplot" target="_blank">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.youtube.com/@derecksyoutube" target="_blank">
    <span class="fa fa-youtube fa-lg"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://derecksnotes.com" target="_blank">derecksnotes.com</a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level2">
<h2 id="dmplot">dmplot<a class="anchor" aria-label="anchor" href="#dmplot"></a>
</h2>
<!-- badges: start -->

<p><code>R</code> framework written in high-performance <code>C++</code> and <code>ggplot2</code> for financial and time series data analysis.</p>
<p>The package provides algorithms, functions, <code>ggplot2</code> layers and most importantly a framework for working with and analysing financial and time series data.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install <code>dmplot</code> using:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("remotes")</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"dereckmezquita/dmplot"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="load-libraries">Load libraries<a class="anchor" aria-label="anchor" href="#load-libraries"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span><span class="va">kucoin</span><span class="op">[</span> <span class="va">get_market_data</span> <span class="op">]</span><span class="op">)</span></span>
<span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span>dt <span class="op">=</span> <span class="va">data.table</span><span class="op">)</span></span>
<span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span><span class="va">ggplot2</span><span class="op">)</span></span>
<span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span><span class="va">dmplot</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<div class="section level3">
<h3 id="get-financial-data">Get financial data<a class="anchor" aria-label="anchor" href="#get-financial-data"></a>
</h3>
<p><a href="https://github.com/dereckmezquita/kucoin" class="external-link"><code>kucoin</code></a> is a package for interacting with the <a href="https://www.kucoin.com" class="external-link"><code>kucoin</code></a> api. You can use any source of financial data as long as you pass the variables to the <code>ggplot2</code> stat correctly.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ticker</span> <span class="op">&lt;-</span> <span class="st">"BTC/USDT"</span></span>
<span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">get_market_data</span><span class="op">(</span></span>
<span>    symbols <span class="op">=</span> <span class="va">ticker</span>,</span>
<span>    from <span class="op">=</span> <span class="st">"2024-07-01 10:36:50 EST"</span>, <span class="co"># lubridate::now() - lubridate::days(7),</span></span>
<span>    to <span class="op">=</span> <span class="st">"2024-07-08 10:36:53 EST"</span>, <span class="co"># lubridate::now(),</span></span>
<span>    frequency <span class="op">=</span> <span class="st">"1 hour"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;      symbol            datetime    open    high     low   close    volume</span></span>
<span><span class="co">#&gt;      &lt;char&gt;              &lt;POSc&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;   &lt;num&gt;     &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: BTC/USDT 2024-07-01 10:00:00 62942.7 62978.1 62779.0 62851.0  52.82884</span></span>
<span><span class="co">#&gt; 2: BTC/USDT 2024-07-01 11:00:00 62850.9 62862.5 62599.7 62663.7  81.03310</span></span>
<span><span class="co">#&gt; 3: BTC/USDT 2024-07-01 12:00:00 62663.8 62914.7 62643.8 62880.5  69.31822</span></span>
<span><span class="co">#&gt; 4: BTC/USDT 2024-07-01 13:00:00 62880.6 63084.0 62520.6 62687.4 125.46135</span></span>
<span><span class="co">#&gt; 5: BTC/USDT 2024-07-01 14:00:00 62687.5 62941.5 62605.0 62822.6 111.57547</span></span>
<span><span class="co">#&gt; 6: BTC/USDT 2024-07-01 15:00:00 62818.8 63147.5 62817.9 63126.9  79.18494</span></span>
<span><span class="co">#&gt; 1 variable(s) not shown: [turnover &lt;num&gt;]</span></span></code></pre></div>
<p>NOTE: a demo dataset is included in the <code>demo/data/</code> directory.</p>
</div>
<div class="section level3">
<h3 id="working-with-and-plotting-financial-data">Working with and plotting financial data<a class="anchor" aria-label="anchor" href="#working-with-and-plotting-financial-data"></a>
</h3>
<p>Here I demonstrate how to use the stats for plotting financial data along with the theme functions included in this package:</p>
<ol style="list-style-type: decimal">
<li><code>dmplot::stat_candlesticks()</code></li>
<li><code><a href="reference/stat_bollingerbands.html">dmplot::stat_bollingerbands()</a></code></li>
<li><code><a href="reference/stat_movingaverages.html">dmplot::stat_movingaverages()</a></code></li>
<li><code><a href="reference/stat_macd.html">dmplot::stat_macd()</a></code></li>
</ol>
<p>And the theme functions for styling:</p>
<ol style="list-style-type: decimal">
<li><code><a href="reference/theme_dereck_dark.html">dmplot::theme_dereck_dark()</a></code></li>
<li><code><a href="reference/theme_dereck_light.html">dmplot::theme_dereck_light()</a></code></li>
</ol>
<p>The <code>dmplot</code> framework provides a number of high-performance <code>C++</code> implementations of technical indicators which can be used directly in the <code>data.table</code> <code>:=</code> operator. This allows one to leverage the power of <code>data.table</code> and the speed of <code>C++</code> for calculations.</p>
<ol style="list-style-type: decimal">
<li>
<code><a href="reference/bb.html">dmplot::bb()</a></code> - Bollinger Bands</li>
<li>
<code><a href="reference/ema.html">dmplot::ema()</a></code> - Exponential Moving Average, with wilder argument</li>
<li>
<code><a href="reference/macd.html">dmplot::macd()</a></code> - Moving Average Convergence Divergence</li>
<li>
<code><a href="reference/mom.html">dmplot::mom()</a></code> - Momentum</li>
<li>
<code><a href="reference/monte_carlo.html">dmplot::monte_carlo()</a></code> - Monte Carlo simulation</li>
<li>
<code><a href="reference/roc.html">dmplot::roc()</a></code> - Rate of Change</li>
<li>
<code><a href="reference/rsi.html">dmplot::rsi()</a></code> - Relative Strength Index</li>
<li>
<code><a href="reference/sma.html">dmplot::sma()</a></code> - Simple Moving Average</li>
</ol>
<p>One can easily use external packages to calculate indicators as long as they return a <code>list</code> or can be coerced to a <code>list</code>.</p>
<p>The reason for this is that we want to impose the use of “Tidy Data” principles, as this is the convention that <code>ggplot2</code> follows and would allow us to easily build our analyses and plots in layers.</p>
<p>For more information on working with <code>dmplot</code> see <a href="articles/getting-started-with-the-dmplot-framwork.html">Getting started with the dmplot framework</a>.</p>
<div class="section level4">
<h4 id="ema-and-bollinger-bands">EMA and Bollinger Bands<a class="anchor" aria-label="anchor" href="#ema-and-bollinger-bands"></a>
</h4>
<p>Here we demonstrate how one might use an external package to calculate an indicator such as EMA (<code>TTR</code>). <code>dmplot</code> also provides a high-performance <code>C++</code> implmentation of <code>ema</code> and <code>bb</code> which can be used directly in the <code>data.table</code> <code>:=</code> operator.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span><span class="va">TTR</span><span class="op">[</span> <span class="va">EMA</span> <span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">$</span><span class="fu">copy</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># wrap to return a list</span></span>
<span><span class="va">ema</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">n</span>, <span class="va">wilder</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">EMA</span><span class="op">(</span><span class="va">x</span>, n <span class="op">=</span> <span class="va">n</span>, wilder <span class="op">=</span> <span class="va">wilder</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># calculate the short and long moving averages</span></span>
<span><span class="va">data2</span><span class="op">[</span>, <span class="va">ema_short</span> <span class="op">:=</span> <span class="fu"><a href="reference/ema.html">ema</a></span><span class="op">(</span><span class="va">close</span>, n <span class="op">=</span> <span class="fl">10</span>, wilder <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">data2</span><span class="op">[</span>, <span class="va">ema_long</span> <span class="op">:=</span> <span class="fu"><a href="reference/ema.html">ema</a></span><span class="op">(</span><span class="va">close</span>, n <span class="op">=</span> <span class="fl">50</span>, wilder <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># use dmplot's C++ implementation of bollinger bands</span></span>
<span><span class="va">data2</span><span class="op">[</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bb_lower"</span>, <span class="st">"bb_mavg"</span>, <span class="st">"bb_upper"</span>, <span class="st">"bb_pct"</span><span class="op">)</span> <span class="op">:=</span> <span class="va">dmplot</span><span class="op">$</span><span class="fu">bb</span><span class="op">(</span><span class="va">close</span>, n <span class="op">=</span> <span class="fl">10</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">data2</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">datetime</span>, <span class="va">close</span>, <span class="va">ema_short</span>, <span class="va">ema_long</span>, <span class="va">bb_lower</span>, <span class="va">bb_mavg</span>, <span class="va">bb_upper</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;               datetime   close ema_short ema_long bb_lower  bb_mavg bb_upper</span></span>
<span><span class="co">#&gt;                 &lt;POSc&gt;   &lt;num&gt;     &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;    &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 2024-07-08 05:00:00 55479.1  56208.32 57477.51 54344.97 55769.94 57194.91</span></span>
<span><span class="co">#&gt; 2: 2024-07-08 06:00:00 55629.8  56150.47 57440.56 54589.01 55606.22 56623.43</span></span>
<span><span class="co">#&gt; 3: 2024-07-08 07:00:00 55843.9  56119.81 57408.62 54726.81 55531.58 56336.35</span></span>
<span><span class="co">#&gt; 4: 2024-07-08 08:00:00 57773.6  56285.19 57415.92 54157.92 55669.65 57181.38</span></span>
<span><span class="co">#&gt; 5: 2024-07-08 09:00:00 57514.7  56408.14 57417.90 53958.81 55835.80 57712.79</span></span>
<span><span class="co">#&gt; 6: 2024-07-08 10:00:00 56817.6  56449.09 57405.89 54113.75 56006.43 57899.11</span></span></code></pre></div>
<p>Because of the <code>dmplot</code> framework we can build our analyses and plots in layers. First we create the candlestick plot and then add the EMA and Bollinger Bands in separate layers. This would allow us to dynamically overlay different indicators and analyses.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">candle_plot</span> <span class="op">&lt;-</span> <span class="va">data2</span> <span class="op">|&gt;</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span></span>
<span>        x <span class="op">=</span> <span class="va">datetime</span>,</span>
<span>        open <span class="op">=</span> <span class="va">open</span>,</span>
<span>        high <span class="op">=</span> <span class="va">high</span>,</span>
<span>        low <span class="op">=</span> <span class="va">low</span>,</span>
<span>        close <span class="op">=</span> <span class="va">close</span></span>
<span>    <span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co">## ------------------------------------</span></span>
<span>    <span class="va">dmplot</span><span class="op">$</span><span class="fu">stat_candlestick</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co">## ------------------------------------</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">scale_x_datetime</span><span class="op">(</span>date_breaks <span class="op">=</span> <span class="st">"1 day"</span>, date_labels <span class="op">=</span> <span class="st">"%b %d"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">labs</span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">ticker</span>, <span class="st">"- Candlestick with EMA and Bollinger Bands"</span><span class="op">)</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"Price (USD)"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">dmplot</span><span class="op">$</span><span class="fu">theme_dereck_dark</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">theme</span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ema_layer</span> <span class="op">&lt;-</span> <span class="va">dmplot</span><span class="op">$</span><span class="fu">stat_movingaverages</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data2</span>,</span>
<span>        <span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span>, short <span class="op">=</span> <span class="va">ema_short</span>, long <span class="op">=</span> <span class="va">ema_long</span><span class="op">)</span>,</span>
<span>        alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mavg <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>        colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"cyan"</span>, <span class="st">"magenta"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="va">bb_layer</span> <span class="op">&lt;-</span> <span class="va">dmplot</span><span class="op">$</span><span class="fu">stat_bollingerbands</span><span class="op">(</span>data <span class="op">=</span> <span class="va">data2</span>,</span>
<span>        <span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">bb_lower</span>, mavg <span class="op">=</span> <span class="va">bb_mavg</span>, ymax <span class="op">=</span> <span class="va">bb_upper</span><span class="op">)</span>,</span>
<span>        colour <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"pink"</span>, <span class="st">"cyan"</span>, <span class="st">"cyan"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">candle_plot</span> <span class="op">+</span> <span class="va">ema_layer</span> <span class="op">+</span> <span class="va">bb_layer</span><span class="op">)</span></span></code></pre></div>
<p><img src="./reference/figures/README-plot-ema-bollinger-1.png" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="macd">MACD<a class="anchor" aria-label="anchor" href="#macd"></a>
</h4>
<p>Plotting the MACD (moving average convergence divergence) indicator:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data2</span> <span class="op">&lt;-</span> <span class="va">dt</span><span class="op">$</span><span class="fu">copy</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data2</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"macd"</span>, <span class="st">"macd_signal"</span><span class="op">)</span> <span class="op">:=</span> <span class="va">dmplot</span><span class="op">$</span><span class="fu">macd</span><span class="op">(</span><span class="va">close</span>, s <span class="op">=</span> <span class="fl">12</span>, l <span class="op">=</span> <span class="fl">26</span>, k <span class="op">=</span> <span class="fl">9</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">data2</span><span class="op">[</span>, <span class="va">macd_diff</span> <span class="op">:=</span> <span class="va">macd</span> <span class="op">-</span> <span class="va">macd_signal</span><span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">data2</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span><span class="va">datetime</span>, <span class="va">close</span>, <span class="va">macd</span>, <span class="va">macd_signal</span>, <span class="va">macd_diff</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt;               datetime   close       macd macd_signal   macd_diff</span></span>
<span><span class="co">#&gt;                 &lt;POSc&gt;   &lt;num&gt;      &lt;num&gt;       &lt;num&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: 2024-07-08 05:00:00 55479.1 -0.9768488  -0.7276772 -0.24917161</span></span>
<span><span class="co">#&gt; 2: 2024-07-08 06:00:00 55629.8 -0.9398049  -0.7701027 -0.16970222</span></span>
<span><span class="co">#&gt; 3: 2024-07-08 07:00:00 55843.9 -0.8695678  -0.7899957 -0.07957204</span></span>
<span><span class="co">#&gt; 4: 2024-07-08 08:00:00 57773.6 -0.5298231  -0.7379612  0.20813814</span></span>
<span><span class="co">#&gt; 5: 2024-07-08 09:00:00 57514.7 -0.2950758  -0.6493841  0.35430831</span></span>
<span><span class="co">#&gt; 6: 2024-07-08 10:00:00 56817.6 -0.2066996  -0.5608472  0.35414763</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">macd_plot</span> <span class="op">&lt;-</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">ggplot</span><span class="op">(</span><span class="va">data2</span>, <span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">datetime</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co">## ------------------------------------</span></span>
<span>    <span class="va">dmplot</span><span class="op">$</span><span class="fu">stat_macd</span><span class="op">(</span></span>
<span>        <span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span>macd <span class="op">=</span> <span class="va">macd</span>, macd_signal <span class="op">=</span> <span class="va">macd_signal</span>, macd_diff <span class="op">=</span> <span class="va">macd_diff</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">scale_x_datetime</span><span class="op">(</span></span>
<span>        date_breaks <span class="op">=</span> <span class="st">"12 hour"</span>, date_labels <span class="op">=</span> <span class="st">"%Y-%m-%d %H:%M"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">scale_y_continuous</span><span class="op">(</span>n.breaks <span class="op">=</span> <span class="fl">15</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">labs</span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">ticker</span>, <span class="st">"- MACD"</span><span class="op">)</span>,</span>
<span>        x <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>        y <span class="op">=</span> <span class="st">"MACD Value"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">dmplot</span><span class="op">$</span><span class="fu">theme_dereck_dark</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">theme</span><span class="op">(</span></span>
<span>        axis.text.x <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">macd_plot</span><span class="op">)</span></span></code></pre></div>
<p><img src="./reference/figures/README-plot-macd-1.png" style="display: block; margin: auto;"></p>
<p>Now let’s do the same plot in a light theme:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">macd_plot</span> <span class="op">+</span></span>
<span>    <span class="va">dmplot</span><span class="op">$</span><span class="fu">theme_dereck_light</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">theme</span><span class="op">(</span></span>
<span>        axis.text.x <span class="op">=</span> <span class="va">ggplot2</span><span class="op">$</span><span class="fu">element_text</span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>        panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p><img src="./reference/figures/README-plot-financial-data-3-1.png" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level3">
<h3 id="benchmarking-dmplots-high-performance-c-technical-indicators">Benchmarking <code>dmplot</code>’s high-performance C++ technical indicators<a class="anchor" aria-label="anchor" href="#benchmarking-dmplots-high-performance-c-technical-indicators"></a>
</h3>
<p>Here we do a simple demonstration and benchmark of <code>dmplot</code>’s Bolinger Bands implementation vs the <code>TTR</code> package. Note that despite using a version not wrapped to return a <code>list</code> the <code>TTR</code> implementation is still significantly slower than <code>dmplot</code>’s C++ implementation.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span><span class="va">microbenchmark</span><span class="op">[</span> <span class="va">microbenchmark</span> <span class="op">]</span><span class="op">)</span></span>
<span><span class="fu">box</span><span class="fu">::</span><span class="fu"><a href="http://klmr.me/box/reference/use.html" class="external-link">use</a></span><span class="op">(</span><span class="va">TTR</span><span class="op">[</span> <span class="va">BBands</span> <span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ttr_bb_wrapped</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">close</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">2</span>, <span class="va">sd</span> <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">BBands</span><span class="op">(</span><span class="va">close</span>, n <span class="op">=</span> <span class="va">n</span>, sd <span class="op">=</span> <span class="va">sd</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">benchmark_reps</span> <span class="op">&lt;-</span> <span class="fl">10L</span></span>
<span><span class="va">time_interval</span> <span class="op">&lt;-</span> <span class="fl">5L</span></span>
<span><span class="va">standard_dev</span> <span class="op">&lt;-</span> <span class="fl">2L</span></span>
<span></span>
<span><span class="va">single_micro</span> <span class="op">&lt;-</span> <span class="fu">microbenchmark</span><span class="op">(</span></span>
<span>    ttr_bb_naked <span class="op">=</span> <span class="fu">BBands</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">close</span>, n <span class="op">=</span> <span class="va">time_interval</span>, sd <span class="op">=</span> <span class="va">standard_dev</span><span class="op">)</span>,</span>
<span>    ttr_bb_wrapped <span class="op">=</span> <span class="fu">ttr_bb_wrapped</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">close</span>, n <span class="op">=</span> <span class="va">time_interval</span>, sd <span class="op">=</span> <span class="va">standard_dev</span><span class="op">)</span>,</span>
<span>    dmplot_bb <span class="op">=</span> <span class="va">dmplot</span><span class="op">$</span><span class="fu">bb</span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">close</span>, n <span class="op">=</span> <span class="va">time_interval</span>, sd <span class="op">=</span> <span class="va">standard_dev</span><span class="op">)</span>,</span>
<span></span>
<span>    times <span class="op">=</span> <span class="va">benchmark_reps</span></span>
<span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">ggplot2</span><span class="op">$</span><span class="fu">autoplot</span><span class="op">(</span><span class="va">single_micro</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">dmplot</span><span class="op">$</span><span class="fu">theme_dereck_dark</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">geom_violin</span><span class="op">(</span><span class="va">ggplot2</span><span class="op">$</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">expr</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">scale_fill_manual</span><span class="op">(</span></span>
<span>        values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ttr_bb_naked"</span> <span class="op">=</span> <span class="st">"red"</span>, <span class="st">"ttr_bb_wrapped"</span> <span class="op">=</span> <span class="st">"red"</span>, <span class="st">"dmplot_bb"</span> <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">labs</span><span class="op">(</span></span>
<span>        title <span class="op">=</span> <span class="st">"dmpplot vs TTR BBands"</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="va">ggplot2</span><span class="op">$</span><span class="fu">theme</span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></code></pre></div>
<p><img src="./reference/figures/README-benchmark-bollinger-bands-1.png" style="display: block; margin: auto;"></p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/dereckmezquita/dmplot/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing dmplot</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://derecksnotes.com" class="external-link">Dereck Mezquita</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-9307-6762" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://www.tidyverse.org/lifecycle/#experimental" class="external-link"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://travis-ci.org/dereckmezquita/kucoin" class="external-link"><img src="https://travis-ci.org/dereckmezquita/kucoin.svg?branch=master" alt="Travis build status"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://derecksnotes.com" class="external-link">Dereck Mezquita</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
